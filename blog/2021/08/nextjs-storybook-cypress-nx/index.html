<!DOCTYPE html>
<html lang="en-us"><head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="generator" content="Hugo 0.53" />
	
	<link rel="shortcut icon" href="/assets/images/sitelogo.jpeg">
	
	<title>Use Cypress with Next.js and Nx to battle test your React Components | juri.dev</title>
	
	<meta name="description" content="Learn how to use Next.js, Nx and Tailwind together">
	
	
	<meta name="robots" content="index, follow">

	
	<meta name="author" content="Juri Strumpflohner">
	<link rel="me" href="https://profiles.google.com/104904743888756261987" />
	<link rel="publisher" href='https://plus.google.com/104904743888756261987' />
	<meta property="twitter:account_id" content="14407063" />


	
	<meta name="google-site-verification" content="0_vyoIaeMG1kXR0h-48gy3OaGl8xoiSJsFDxxCTIBMs" />
	<meta name="google-site-verification" content="AvmssSjl_nchNXIqBW8Agb_UjGqvvLP7HXSxBZ9d0cg" />

	
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:site" content="@juristr" />
	<meta name="twitter:creator" content="@juristr" />
	<meta name="twitter:title" content="Use Cypress with Next.js and Nx to battle test your React Components" />
	
	<meta name="twitter:description" content="Learn how to use Next.js, Nx and Tailwind together" />
	

	
	<meta name="twitter:image:src" content="https://juristr.com/blog/assets/imgs/nextjs-nx-series/nextjs-nx-storybook-cypress-cover.jpg" />
	

	
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Use Cypress with Next.js and Nx to battle test your React Components" />
	
	<meta property="og:description" content="Learn how to use Next.js, Nx and Tailwind together" />
	
	
	<meta property="og:image" content="https://juristr.com/blog/assets/imgs/nextjs-nx-series/nextjs-nx-storybook-cypress-cover.jpg" />
	
	<meta property="og:url" content="https://juristr.com/blog/2021/08/nextjs-storybook-cypress-nx" />
	<meta property="og:site_name" content="juristr.com" />

	
	<link rel="alternate" type="application/rss+xml" title="Juri Strumpflohner" href="//feeds.feedburner.com/juristrumpflohner">
	

	
	<link href="/css/bootstrap.min.css" rel="stylesheet">

	
	
	<link href='//fonts.googleapis.com/css?family=Righteous|Roboto:400,700,900|Source+Code+Pro|Lora:400,700,400italic|Material+Icons'
	 rel='stylesheet' type='text/css'>
	

	

	
	
	
	<link rel="stylesheet" href="/scss/main.min.css" integrity="" media="screen">

	

	

	
	
	<link rel="stylesheet" href="/scss/article.min.css" integrity="" media="screen">
	

	
	
	<script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>
<body>
<header class="navbar-light bg-white fixed-top mediumnavigation nav-down">
    <div class="container">

        
        <div class="row justify-content-center align-items-center brandrow">

            <div class="col-lg-4 col-md-4 col-xs-12 d-none d-md-block hidden-xs customarea">
                <img src="/assets/images/gde.svg" style="height:23px">
                <a href="https://developers.google.com/community/experts/directory/profile/profile-juri_strumpflohner" style="
                    padding-left: 5px;
                    font-size: 15pt;
                ">GDE
                    for Web Tech</a>
                

            </div>

            <div class="col-lg-4 col-md-4  col-xs-12 text-center logoarea">
                <a class="navbar-brand" href="https://juristr.com/">
                    
                    <span style="font-family:Righteous;">juri.dev</span>
                    
                </a>
                
            </div>

            <div class="col-lg-4 col-md-4  col-xs-12 text-right d-none d-md-block">
                <a href="https://twitter.com/juristr" class="twitter-follow-button" data-show-count="true">Follow me!</a>
                <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
            </div>

        </div>
        

        <div class="navarea">

            <nav class="navbar navbar-toggleable-sm">
                
                <div id="bs4navbar" class="navbar-collapse">
                    
                    <ul id="menu-top-menu" class="navbar-nav col-md-12 justify-content-center">
                        
                        <li class="menu-item ">
                            <a class="nav-link" href="/">Home</a>
                        </li>
                        
                        <li class="menu-item ">
                            <a class="nav-link" href="/blog">Blog</a>
                        </li>
                        
                        <li class="menu-item ">
                            <a class="nav-link" href="/categories">Collections</a>
                        </li>
                        
                        <li class="menu-item ">
                            <a class="nav-link" href="/newsletter">Newsletter</a>
                        </li>
                        
                        <li class="menu-item ">
                            <a class="nav-link" href="https://github.com/juristr/ama">AMA</a>
                        </li>
                        
                        <li class="menu-item ">
                            <a class="nav-link" href="/about">About Me</a>
                        </li>
                        
                    </ul>

                    
                </div>
            </nav>

        </div>

    </div>

</header>

    <div class="site-content">



<div class="container page-container">
    <div class="row">
        
        <div class="col-md-2 pl-0"><div class="share">
    <p>
        Share
    </p>
    <ul>
        <li>
            <a target="_blank" href="https://twitter.com/home?status=Check out this post by @juristr https%3a%2f%2fjuristr.com%2fblog%2f2021%2f08%2fnextjs-storybook-cypress-nx%2f">
                <svg class="svgIcon-use" width="29" height="29" viewbox="0 0 29 29">
                    <path d="M21.967 11.8c.018 5.93-4.607 11.18-11.177 11.18-2.172 0-4.25-.62-6.047-1.76l-.268.422-.038.5.186.013.168.012c.3.02.44.032.6.046 2.06-.026 3.95-.686 5.49-1.86l1.12-.85-1.4-.048c-1.57-.055-2.92-1.08-3.36-2.51l-.48.146-.05.5c.22.03.48.05.75.08.48-.02.87-.07 1.25-.15l2.33-.49-2.32-.49c-1.68-.35-2.91-1.83-2.91-3.55 0-.05 0-.01-.01.03l-.49-.1-.25.44c.63.36 1.35.57 2.07.58l1.7.04L7.4 13c-.978-.662-1.59-1.79-1.618-3.047a4.08 4.08 0 0 1 .524-1.8l-.825.07a12.188 12.188 0 0 0 8.81 4.515l.59.033-.06-.59v-.02c-.05-.43-.06-.63-.06-.87a3.617 3.617 0 0 1 6.27-2.45l.2.21.28-.06c1.01-.22 1.94-.59 2.73-1.09l-.75-.56c-.1.36-.04.89.12 1.36.23.68.58 1.13 1.17.85l-.21-.45-.42-.27c-.52.8-1.17 1.48-1.92 2L22 11l.016.28c.013.2.014.35 0 .52v.04zm.998.038c.018-.22.017-.417 0-.66l-.498.034.284.41a8.183 8.183 0 0 0 2.2-2.267l.97-1.48-1.6.755c.17-.08.3-.02.34.03a.914.914 0 0 1-.13-.292c-.1-.297-.13-.64-.1-.766l.36-1.254-1.1.695c-.69.438-1.51.764-2.41.963l.48.15a4.574 4.574 0 0 0-3.38-1.484 4.616 4.616 0 0 0-4.61 4.613c0 .29.02.51.08.984l.01.02.5-.06.03-.5c-3.17-.18-6.1-1.7-8.08-4.15l-.48-.56-.36.64c-.39.69-.62 1.48-.65 2.28.04 1.61.81 3.04 2.06 3.88l.3-.92c-.55-.02-1.11-.17-1.6-.45l-.59-.34-.14.67c-.02.08-.02.16 0 .24-.01 2.12 1.55 4.01 3.69 4.46l.1-.49-.1-.49c-.33.07-.67.12-1.03.14-.18-.02-.43-.05-.64-.07l-.76-.09.23.73c.57 1.84 2.29 3.14 4.28 3.21l-.28-.89a8.252 8.252 0 0 1-4.85 1.66c-.12-.01-.26-.02-.56-.05l-.17-.01-.18-.01L2.53 21l1.694 1.07a12.233 12.233 0 0 0 6.58 1.917c7.156 0 12.2-5.73 12.18-12.18l-.002.04z"></path>
                </svg>
            </a>
        </li>
        <li>
            <a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fjuristr.com%2fblog%2f2021%2f08%2fnextjs-storybook-cypress-nx%2f">
                <svg class="svgIcon-use" width="29" height="29" viewbox="0 0 29 29">
                    <path d="M16.39 23.61v-5.808h1.846a.55.55 0 0 0 .546-.48l.36-2.797a.551.551 0 0 0-.547-.62H16.39V12.67c0-.67.12-.813.828-.813h1.474a.55.55 0 0 0 .55-.55V8.803a.55.55 0 0 0-.477-.545c-.436-.06-1.36-.116-2.22-.116-2.5 0-4.13 1.62-4.13 4.248v1.513H10.56a.551.551 0 0 0-.55.55v2.797c0 .304.248.55.55.55h1.855v5.76c-4.172-.96-7.215-4.7-7.215-9.1 0-5.17 4.17-9.36 9.31-9.36 5.14 0 9.31 4.19 9.31 9.36 0 4.48-3.155 8.27-7.43 9.15M14.51 4C8.76 4 4.1 8.684 4.1 14.46c0 5.162 3.75 9.523 8.778 10.32a.55.55 0 0 0 .637-.543v-6.985a.551.551 0 0 0-.55-.55H11.11v-1.697h1.855a.55.55 0 0 0 .55-.55v-2.063c0-2.02 1.136-3.148 3.03-3.148.567 0 1.156.027 1.597.06v1.453h-.924c-1.363 0-1.93.675-1.93 1.912v1.78c0 .3.247.55.55.55h2.132l-.218 1.69H15.84c-.305 0-.55.24-.55.55v7.02c0 .33.293.59.623.54 5.135-.7 9.007-5.11 9.007-10.36C24.92 8.68 20.26 4 14.51 4"></path>
                </svg>
            </a>
        </li>
    </ul>
    
</div></div>
        
        <div class="col-md-9 col-md-offset-2 col-xs-12">
            <div class="mainheading">

                
                
                
                
                <div class="row post-top-meta">
                    
                    <div class="col-md-2">
                        <img class="author-thumb" src="https://www.gravatar.com/avatar/64537dfe80f44978663e378d375c7138?s=150&amp;d=identicon&amp;r=PG" alt="Juri Strumpflohner">
                    </div>
                    <div class="col-md-10">
                        <a class="link-dark" href="/about/">Juri Strumpflohner</a><a href="https://twitter.com/@juristr"
                            class="btn follow">Follow</a>
                        <span class="author-description">Juri is a full stack developer and tech lead with a special passion for the web and frontend development. He creates online videos for <a href="https://egghead.io/instructors/juri-strumpflohner">Egghead.io</a>, writes articles on his blog and for tech magazines, speaks at conferences and holds training workshops. Juri is also a recognized Google Developer Expert in Web Technologies</span>
                        
                    </div>
                    
                </div>
                
                
                
                

                <h1 class="posttitle">Use Cypress with Next.js and Nx to battle test your React Components</h1>
                
                <h2 class="article-subtitle">Learn how to use Next.js, Nx and Tailwind together</h2>
                
                <p>
                    <span class="post-date">
                        <time class="post-date">
                            Aug 18, 2021
                        </time></span>
                    <span class="dot"></span>
                    <span class="post-read">7 min read</span>
                </p>
            </div>

            
            
            

            
            <a href="https://egghead.io/courses/productive-git-for-developers?af=fj2vsx" class="external-link" data-client="eggheadio" data-uid="url">
                <img src="/assets/images/banners/egghead-banner-productive-git.png" style="width:100%" />
            </a>
            

            
            <div class="article-post">
                <div class="article-intro">
    In the <a href="/blog/2021/08/nextjs-storybook-tailwind-nx/">previous article</a>, we talked about how Nx comes with first-class support for setting up Storybook. Nx also automatically generates Cypress e2e tests for the various Storybook stories, which is exactly what we&rsquo;re going to explore in this article.
</div>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9669473064376287" data-ad-slot="2496274486"
    data-ad-format="auto"></ins>
<script>
    (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<p><strong>Building a blog with Next.js and Nx Series</strong><br />
This article is part of a series around building a blog with Nx, Next.js, Tailwind, Storybook and Cypress.</p>

<ul>
<li><a href="/blog/2021/06/create-nextjs-webapp-nx">Create a Next.js web app with Nx</a></li>
<li><a href="/blog/2021/06/setup-tailwind-nextjs-and-nx/">Setup Next.js to use Tailwind with Nx</a></li>
<li><a href="/blog/2021/06/read-render-markdown-nextjs-and-nx/">Read and render Markdown files with Next.js and Nx</a></li>
<li><a href="/blog/2021/07/component-hydration-nextjs-nx/">Component hydration with MDX in Next.js and Nx</a></li>
<li><a href="/blog/2021/07/fast-refresh-mdx-files-next-and-nx/">Hot Reload MDX changes in Next.js with Nx</a></li>
<li><a href="/blog/2021/07/nextjs-workspace-generator-blog-draft/">Using Nx Workspace generators to scaffold new blog posts</a></li>
<li><a href="/blog/2021/08/nextjs-storybook-tailwind-nx/">Use Storybook with Next.js, Tailwind and Nx to develop components in isolation</a></li>
<li><strong>Use Cypress with Next.js and Nx to battle test your React Components</strong></li>
<li>Publishing a Next.js site to Vercel with Nx <em>(soon)</em></li>
</ul>

<p><em>Check back later, <a href="https://twitter.com/juristr">follow me on Twitter</a> or <a href="/newsletter">subscribe to the Newsletter</a> to get updates about upcoming articles</em></p>

<hr />
<div class="article-toc">
    <strong>Table of contents</strong>
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#writing-cypress-e2e-tests-for-your-next-js-application">Writing Cypress e2e tests for your Next.js application</a></li>
<li><a href="#writing-cypress-e2e-tests-for-our-previously-created-storybook-stories">Writing Cypress e2e tests for our previously created Storybook stories</a></li>
<li><a href="#launch-storybook-cypress-e2e-tests">Launch Storybook Cypress e2e tests</a></li>
<li><a href="#implementing-the-cypress-test-for-our-storybook-story">Implementing the Cypress test for our Storybook story</a>
<ul>
<li><a href="#test-case-1">Test case 1</a></li>
<li><a href="#test-case-2">Test case 2</a></li>
</ul></li>
<li><a href="#running-cypress-tests">Running Cypress tests</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul></li>
</ul>
</nav>
</div>
<hr />

<p>Adding automated tests for our personal blog platform is probably overkill and most people wouldn&rsquo;t probably do. One of the key benefits of Nx is that it automatically integrates a variety of tools. So far in the series, we&rsquo;ve seen</p>

<ul>
<li>automated setup of Next.js apps with TypeScript support</li>
<li>allowing to split your application logic into separate libraries and seamlessly integrate them into an application, in our case a Next.js based one</li>
<li>integrating Storybook with React components and TypeScript</li>
</ul>

<p>By having Nx generate these configs for you, you don&rsquo;t have to deal with the complexity of setting up all these tools. Also, it will lower the entry barrier and friction for developers to start using them. Such as the automated Cypress setup. I probably wouldn&rsquo;t write Cypress tests for my personal blog platform, but given the hard task of setting everything up is already done, what&rsquo;s left is really only to write some high-level tests.</p>

<h2 id="writing-cypress-e2e-tests-for-your-next-js-application">Writing Cypress e2e tests for your Next.js application</h2>

<p>Right at the very beginning of this series when we <a href="/blog/2021/06/create-nextjs-webapp-nx/">generated our Nx workspace with the Next.js preset</a>, you might have noticed that we also got a <code>apps/site-e2e</code> folder setup automatically.</p>


<figure class="image--medium">

    
        
        <a href="/blog/assets/imgs/nextjs-nx-series/next-cypress-e2e-folderstructure.png" class="image--zoom">
            <img src="/blog/assets/imgs/nextjs-nx-series/next-cypress-e2e-folderstructure.png" loading="lazy" class="lazyload"/>
        </a>
    
    <figcaption></figcaption>
</figure>



<p>Nx also generated a default Cypress spec file:</p>
<div class="highlight"><pre class="chroma"><code class="language-ts" data-lang="ts"><span class="c1">// apps/site-e2e/src/integration/app.spec.ts
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span> <span class="nx">getGreeting</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;../support/app.po&#39;</span><span class="p">;</span>

<span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;site&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">beforeEach</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">cy</span><span class="p">.</span><span class="nx">visit</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">));</span>

  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should display welcome message&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// Custom command example, see `../support/commands.ts` file
</span><span class="c1"></span>    <span class="nx">cy</span><span class="p">.</span><span class="nx">login</span><span class="p">(</span><span class="s1">&#39;my-email@something.com&#39;</span><span class="p">,</span> <span class="s1">&#39;myPassword&#39;</span><span class="p">);</span>

    <span class="c1">// Function helper example, see `../support/app.po.ts` file
</span><span class="c1"></span>    <span class="nx">getGreeting</span><span class="p">().</span><span class="nx">contains</span><span class="p">(</span><span class="s1">&#39;Welcome to site!&#39;</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span></code></pre></div>
<p>You can run the Next.js app Cypress tests very much the same way as we did for our Storybook Cypress tests:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">npx nx e2e site-e2e</code></pre></div>
<p>Obviously, they might not pass successfully right now since we&rsquo;ve modified the initially generated application. Let&rsquo;s fix them and to make an example, let&rsquo;s test whether our <a href="/blog/2021/06/read-render-markdown-nextjs-and-nx/">markdown rendered article we&rsquo;ve covered in a previous post</a>, renders properly at <code>/articles/dynamic-routing</code>.</p>


<figure class="image--full">

    
        
        <a href="/blog/assets/imgs/nextjs-nx-series/nextjs-cypress-article-to-test.png" class="image--zoom">
            <img src="/blog/assets/imgs/nextjs-nx-series/nextjs-cypress-article-to-test.png" loading="lazy" class="lazyload"/>
        </a>
    
    <figcaption></figcaption>
</figure>



<p>What we want to test is</p>

<ul>
<li>When navigating to <code>/articles/dynamic-routing</code>, the page loads properly.</li>
<li>The <code>h1</code> contains the expected title of the article.</li>
<li>the embedded Youtube component we talked about in the article about <a href="/blog/2021/07/component-hydration-nextjs-nx/">component hydration with MDX</a> renders properly.</li>
</ul>

<p>We can launch Cypress in &ldquo;watch mode&rdquo; such that we can see the test running as we make adjustments.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">npx nx e2e site-e2e --watch</code></pre></div>
<p>Let&rsquo;s modify the existing <code>apps/site-e2e/src/integration/app.spec.ts</code> file to implement the Cypress test.</p>

<blockquote>
<p><em>Note</em>, you might want to create a dedicated spec file for testing the article loading, while the <code>app.spec.ts</code> might be more suitable for loading more high-level things about the web app. Like whether the navbar loads etc. But for the purpose of demoing the Cypress integration quickly, it works ðŸ™‚.</p>
</blockquote>

<p>Here&rsquo;s the modified test:</p>
<div class="highlight"><pre class="chroma"><code class="language-ts" data-lang="ts"><span class="c1">// apps/site-e2e/src/integration/app.spec.ts
</span><span class="c1"></span><span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;site&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">beforeEach</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// navigate to an example article
</span><span class="c1"></span>    <span class="nx">cy</span><span class="p">.</span><span class="nx">visit</span><span class="p">(</span><span class="s1">&#39;/articles/dynamic-routing&#39;</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should render the title of the article&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">cy</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">).</span><span class="nx">should</span><span class="p">(</span><span class="s1">&#39;contain&#39;</span><span class="p">,</span> <span class="s1">&#39;Dynamic Routing and Static Generation&#39;</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should properly render the Youtube component&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">cy</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;iframe&#39;</span><span class="p">).</span><span class="nx">should</span><span class="p">(</span><span class="s1">&#39;be.visible&#39;</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span></code></pre></div>
<p>If you have a look at the Cypress runner, you should see it pass properly.</p>


<figure class="image--full">

    
        
        <a href="/blog/assets/imgs/nextjs-nx-series/nextjs-cypress-run.png" class="image--zoom">
            <img src="/blog/assets/imgs/nextjs-nx-series/nextjs-cypress-run.png" loading="lazy" class="lazyload"/>
        </a>
    
    <figcaption></figcaption>
</figure>



<h2 id="writing-cypress-e2e-tests-for-our-previously-created-storybook-stories">Writing Cypress e2e tests for our previously created Storybook stories</h2>

<p>Similarly to the Next.js app based e2e tests, Nx also generated e2e tests specifically for our Storybook setup, which we generated in the <a href="/blog/2021/08/nextjs-storybook-tailwind-nx/">previous article</a>. All those tests reside in the <code>apps/storybook-e2e/ui-e2e</code> folder. The reason why they are in a separate &ldquo;storybook-e2e&rdquo; folder is because I specifically passed that as the Cypress directory when generating the Storybook setup.</p>


<figure class="image--medium">

    
        
        <a href="/blog/assets/imgs/nextjs-nx-series/storybook-e2e-treeview.png" class="image--zoom">
            <img src="/blog/assets/imgs/nextjs-nx-series/storybook-e2e-treeview.png" loading="lazy" class="lazyload"/>
        </a>
    
    <figcaption></figcaption>
</figure>



<p>The default Cypress spec generated by Nx is the following:</p>
<div class="highlight"><pre class="chroma"><code class="language-tsx" data-lang="tsx"><span class="c1">// apps/storybook-e2e/ui-e2e/src/integration/topic-button/topic-button.spec.ts
</span><span class="c1"></span><span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;shared-ui: TopicButton component&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">beforeEach</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">cy</span><span class="p">.</span><span class="nx">visit</span><span class="p">(</span><span class="s1">&#39;/iframe.html?id=topicbutton--primary&#39;</span><span class="p">));</span>
    
    <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should render the component&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">cy</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">).</span><span class="nx">should</span><span class="p">(</span><span class="s1">&#39;contain&#39;</span><span class="p">,</span> <span class="s1">&#39;Welcome to TopicButton!&#39;</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">});</span></code></pre></div>
<p>There are a couple of things to notice here in terms of the testing strategy. What Nx leverages here when generating the Storybook tests, is <a href="https://storybook.js.org/docs/react/workflows/interaction-testing">Storybook&rsquo;s interaction testing</a> functionality. That feature allows to directly target the story rendering via a URL:</p>
<div class="highlight"><pre class="chroma"><code class="language-tsx" data-lang="tsx"><span class="nx">cy</span><span class="p">.</span><span class="nx">visit</span><span class="p">(</span><span class="s1">&#39;/iframe.html?id=topicbutton--primary&#39;</span><span class="p">)</span></code></pre></div>
<p>Furthermore, we can control the different component props variation by leveraging the possibility to also pass the <a href="https://storybook.js.org/docs/react/writing-stories/args#setting-args-through-the-url">Story args via the URL</a>:</p>
<div class="highlight"><pre class="chroma"><code class="language-tsx" data-lang="tsx"><span class="nx">cy</span><span class="p">.</span><span class="nx">visit</span><span class="p">(</span><span class="s1">&#39;/iframe.html?id=topicbutton--primary&amp;args=topicName:Next.js;&#39;</span><span class="p">);</span></code></pre></div>
<p>Having that knowledge we can easily develop our Cypress test.</p>

<h2 id="launch-storybook-cypress-e2e-tests">Launch Storybook Cypress e2e tests</h2>
<div class="highlight"><pre class="chroma"><code class="language-json" data-lang="json"><span class="err">npx</span> <span class="err">nx</span> <span class="err">e</span><span class="mi">2</span><span class="err">e</span> <span class="err">storybook-e</span><span class="mi">2</span><span class="err">e-ui-e</span><span class="mi">2</span><span class="err">e</span> <span class="err">--watch</span></code></pre></div>
<p>By passing the <code>--watch</code> flag, we can interact with the Cypress runner which is handy during development. Without the flag, the e2e tests will run in headless mode which is suitable for CI.</p>

<p>When you launch this command, behind the scenes, Nx serves our Storybook for the <code>shared/ui</code> library, followed by launching Cypress and making sure it points to the local Storybook server.</p>

<p>Obviously running the Cypress e2e now wouldn&rsquo;t really work as we&rsquo;ve changed the implementation of our React component meanwhile. So let&rsquo;s fix that.</p>

<h2 id="implementing-the-cypress-test-for-our-storybook-story">Implementing the Cypress test for our Storybook story</h2>

<p>We want to have two different test cases for our simple Topic Button component:</p>

<ol>
<li>make sure it renders the passed <code>topicName</code> properly</li>
<li>make sure it passes the topic name to the event handler when clicking on the Topic button component</li>
</ol>

<h3 id="test-case-1">Test case 1</h3>

<p>In order to have &ldquo;hook points&rdquo; that can be grabbed during the Cypress test run, it is <a href="https://docs.cypress.io/guides/references/best-practices#Selecting-Elements">good practice</a> to use <code>data-testid</code> attributes on the DOM elements which we want to use in our test implementation. Thus, we need to change our <code>topic-button.tsx</code> and add one to the rendering element of our <code>topicName</code> as well as to the entire topic button div:</p>
<div class="highlight"><pre class="chroma"><code class="language-tsx" data-lang="tsx"><span class="c1">// libs/shared/ui/src/lib/topic-button/topic-button.tsx
</span><span class="c1"></span><span class="p">...</span>

<span class="kr">export</span> <span class="kd">function</span> <span class="nx">TopicButton</span><span class="p">(</span><span class="nx">props</span>: <span class="kt">TopicButtonProps</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">...</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">div</span>
      <span class="p">...</span>
      <span class="nx">data</span><span class="o">-</span><span class="nx">testid</span><span class="o">=</span><span class="s2">&#34;topicButton&#34;</span>
    <span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">img</span> <span class="nx">src</span><span class="o">=</span><span class="p">{</span><span class="nx">icon</span><span class="p">}</span> <span class="nx">alt</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;w-12&#34;</span> <span class="err">/&gt;</span>
      <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;p-5&#34;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">h2</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;font-bold text-4xl&#34;</span> <span class="nx">data</span><span class="o">-</span><span class="nx">testid</span><span class="o">=</span><span class="s2">&#34;topicName&#34;</span><span class="o">&gt;</span>
          <span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">topicName</span><span class="p">}</span>
        <span class="o">&lt;</span><span class="err">/h2&gt;</span>
      <span class="o">&lt;</span><span class="err">/div&gt;</span>
    <span class="o">&lt;</span><span class="err">/div&gt;</span>
  <span class="p">);</span>
<span class="p">}</span></code></pre></div>
<p>Then, in our test case, we use <a href="https://storybook.js.org/docs/react/writing-stories/args#setting-args-through-the-url">set the Story args via the URL</a>, in this case passing first <code>topicName:Next.js</code>, and then we verify whether the <code>[data-testid=topicName]</code> element contains the correct name. And to be sure, we also change it to <code>React</code>and assert those changes are reflected in the rendering</p>
<div class="highlight"><pre class="chroma"><code class="language-tsx" data-lang="tsx"><span class="c1">// apps/storybook-e2e/ui-e2e/src/integration/topic-button/topic-button.spec.ts
</span><span class="c1"></span><span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;shared-ui: TopicButton component&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>

  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should render the topic name&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">cy</span><span class="p">.</span><span class="nx">visit</span><span class="p">(</span><span class="s1">&#39;/iframe.html?id=topicbutton--primary&amp;args=topicName:Next.js;&#39;</span><span class="p">);</span>
    <span class="nx">cy</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;[data-testid=topicName]&#39;</span><span class="p">).</span><span class="nx">should</span><span class="p">(</span><span class="s1">&#39;contain&#39;</span><span class="p">,</span> <span class="s1">&#39;Next.js&#39;</span><span class="p">);</span>

    <span class="nx">cy</span><span class="p">.</span><span class="nx">visit</span><span class="p">(</span><span class="s1">&#39;/iframe.html?id=topicbutton--primary&amp;args=topicName:React;&#39;</span><span class="p">);</span>
    <span class="nx">cy</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;[data-testid=topicName]&#39;</span><span class="p">).</span><span class="nx">should</span><span class="p">(</span><span class="s1">&#39;contain&#39;</span><span class="p">,</span> <span class="s1">&#39;React&#39;</span><span class="p">);</span>
  <span class="p">});</span>

<span class="p">});</span></code></pre></div>
<h3 id="test-case-2">Test case 2</h3>

<p>Back when implementing our <code>topic-button.stories.tsx</code> we added a feature to the story that registers to the <code>TopicButton</code>&rsquo;s <code>onClick</code> event and renders the result directly below the button. This makes it particularly easy to test it in our Cypress test. To make it easy to grab the according DOM element in our Cypress test, we add another <code>data-testid=&quot;click-result&quot;</code> to that element.</p>
<div class="highlight"><pre class="chroma"><code class="language-tsx" data-lang="tsx"><span class="c1">// libs/shared/ui/src/lib/topic-button/topic-button.stories.tsx
</span><span class="c1"></span><span class="p">...</span> 

<span class="kr">const</span> <span class="nx">Template</span>: <span class="kt">Story</span><span class="o">&lt;</span><span class="nx">TopicButtonProps</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="p">[</span><span class="nx">clickedTopic</span><span class="p">,</span> <span class="nx">setClickedTopic</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="o">&lt;</span><span class="kt">string</span> <span class="o">|</span> <span class="kc">null</span><span class="o">&gt;</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;bg-gray-100 p-20&#34;</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">TopicButton</span>
        <span class="p">{...</span><span class="nx">args</span><span class="p">}</span>
        <span class="nx">onClick</span><span class="o">=</span><span class="p">{(</span><span class="nx">topicName</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">setClickedTopic</span><span class="p">(</span><span class="nx">topicName</span><span class="p">)}</span>
      <span class="err">/&gt;</span>
      <span class="p">{</span><span class="nx">clickedTopic</span> <span class="o">&amp;&amp;</span> <span class="p">(</span>
        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">data</span><span class="o">-</span><span class="nx">testid</span><span class="o">=</span><span class="s2">&#34;click-result&#34;</span><span class="o">&gt;</span>
          <span class="nx">Button</span> <span class="nx">has</span> <span class="nx">been</span> <span class="nx">clicked</span><span class="o">:</span> <span class="p">{</span><span class="nx">clickedTopic</span><span class="p">}</span>
        <span class="o">&lt;</span><span class="err">/div&gt;</span>
      <span class="p">)}</span>
    <span class="o">&lt;</span><span class="err">/div&gt;</span>
  <span class="p">);</span>
<span class="p">};</span>

<span class="kr">export</span> <span class="kr">const</span> <span class="nx">Primary</span> <span class="o">=</span> <span class="nx">Template</span><span class="p">.</span><span class="nx">bind</span><span class="p">({});</span>
<span class="nx">Primary</span><span class="p">.</span><span class="nx">args</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">topicName</span><span class="o">:</span> <span class="s1">&#39;Next.js&#39;</span><span class="p">,</span>
<span class="p">};</span></code></pre></div>
<p>In the <code>topic-button.spec.ts</code> we add another test case, set the <code>topicName</code> to <code>React</code>, click the topic button component and verify the output matches our expectations:</p>
<div class="highlight"><pre class="chroma"><code class="language-tsx" data-lang="tsx"><span class="c1">// apps/storybook-e2e/ui-e2e/src/integration/topic-button/topic-button.spec.ts
</span><span class="c1"></span><span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;shared-ui: TopicButton component&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should render the topic name&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="p">...</span>
  <span class="p">});</span>

  <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;clicking the icon should properly pass the name of the topic to the event handler&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">cy</span><span class="p">.</span><span class="nx">visit</span><span class="p">(</span><span class="s1">&#39;/iframe.html?id=topicbutton--primary&amp;args=topicName:React;&#39;</span><span class="p">);</span>

    <span class="nx">cy</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;[data-testid=topicButton]&#39;</span><span class="p">).</span><span class="nx">click</span><span class="p">();</span>

    <span class="nx">cy</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;[data-testid=click-result]&#39;</span><span class="p">).</span><span class="nx">should</span><span class="p">(</span><span class="s1">&#39;contain&#39;</span><span class="p">,</span> <span class="s1">&#39;React&#39;</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span></code></pre></div>
<h2 id="running-cypress-tests">Running Cypress tests</h2>

<p>Finally we can run the Cypress tests again</p>
<div class="highlight"><pre class="chroma"><code class="language-tsx" data-lang="tsx"><span class="nx">npx</span> <span class="nx">nx</span> <span class="nx">e2e</span> <span class="nx">storybook</span><span class="o">-</span><span class="nx">e2e</span><span class="o">-</span><span class="nx">ui</span><span class="o">-</span><span class="nx">e2e</span> <span class="o">--</span><span class="nx">watch</span></code></pre></div>
<video width="820" height="440" autoplay muted loop style="border: 1px solid #323f4b">
  <source src="/blog/assets/imgs/nextjs-nx-series/nx-tailwind-cypress-run.mp4" type="video/mp4">
Your browser does not support the video tag.
</video>

<h2 id="conclusion">Conclusion</h2>

<p>In this article we learned</p>

<ul>
<li>How Nx is able to automatically generates a Cypress e2e test for our Nx apps as well as our Storybook stories</li>
<li>How the Cypress setup works</li>
<li>How to implement a simple Cypress test for our Next.js app</li>
<li>How to implement the Cypress e2e test for our Topic button story</li>
</ul>

<p>See also:</p>

<ul>
<li><a href="https://storybook.js.org/docs/react/workflows/interaction-testing">https://storybook.js.org/docs/react/workflows/interaction-testing</a></li>
<li><a href="https://storybook.js.org/docs/react/writing-stories/args#setting-args-through-the-url">https://storybook.js.org/docs/react/writing-stories/args#setting-args-through-the-url</a></li>
<li><a href="https://docs.cypress.io/guides/references/best-practices#Selecting-Elements">https://docs.cypress.io/guides/references/best-practices#Selecting-Elements</a></li>
</ul>

<p><strong>GitHub repository</strong></p>

<p>All the sources for this article can be found in this GitHub repository&rsquo;s branch: <a href="https://github.com/juristr/blog-series-nextjs-nx/tree/08-storybook-cypress-tests">https://github.com/juristr/blog-series-nextjs-nx/tree/08-storybook-cypress-tests</a></p>

				<hr />

				Questions? Thoughts? Hit me up <a href="https://twitter.com/juristr" target="_blank">on Twitter</a>
            </div>

            
            <div class="after-post-tags">
                <ul class="tags">
                    
                    <li>
                        <a href="/tags/Next">Next</a>
                    </li>
                    
                    <li>
                        <a href="/tags/TailwindCSS">TailwindCSS</a>
                    </li>
                    
                    <li>
                        <a href="/tags/React">React</a>
                    </li>
                    
                    <li>
                        <a href="/tags/Storybook">Storybook</a>
                    </li>
                    
                </ul>
            </div>
            

            <a href="https://egghead.io/instructors/juri-strumpflohner" class="external-link" data-client="eggheadio"
                data-uid="egghead-instructor-page">
                <img src="/blog/assets/imgs/egghead-banner-learn-with-me.png" style="width:100%" />
            </a>

            
            
            
        </div>
        
    </div>
</div>

<div class="hideshare"></div>



<div class="related-container">
    <div class="container">
        <div class="row listrecent listrelated">
            
            

            <div class="col-md-4">
<div class="card">
    
    <div class="card-block">
        <h2 class="card-title">
            <a href="/blog/2021/08/nextjs-storybook-tailwind-nx">Use Storybook with Tailwind in an Nx Workspace</a>
        </h2>
        <h4 class="card-text">
            Learn how to use Next.js, Nx and Tailwind together
            
        </h4>
        <div class="metafooter">
            <div class="wrapfooter">
                <div class="row">
                    <div class="col-10">
                        
                            <span class="meta-footer-thumb">
                                <a href="/about/">
                                    <img class="author-thumb" src="https://www.gravatar.com/avatar/64537dfe80f44978663e378d375c7138?s=150&amp;d=identicon&amp;r=PG" alt="Juri Strumpflohner">
                                </a>
                            </span>
                            <span class="author-meta">
                                <span class="post-name"><a href="/about/">Juri Strumpflohner</a></span><br />
                                <span class="post-date">Aug 12, 2021</span><span class="dot"></span><span
                                    class="post-read">10 min read</span>
                            </span>
                        
                    </div>
                    <div class="col-2">
                        
                        
                        
                        <span class="post-category-icon">
                            
                            
                                <img src="/assets/images/categories/next.svg" />
                            
                        </span>
                        
                        
                    </div>
                </div>
            </div>
        </div>
    </div>

    
</div>

            </div>

            

            <div class="col-md-4">
<div class="card">
    
    <div class="card-block">
        <h2 class="card-title">
            <a href="/blog/2021/07/nextjs-workspace-generator-blog-draft/">Using Nx Workspace generators to scaffold new blog posts</a>
        </h2>
        <h4 class="card-text">
            Learn how to use Next.js, Nx and Tailwind together
            
        </h4>
        <div class="metafooter">
            <div class="wrapfooter">
                <div class="row">
                    <div class="col-10">
                        
                            <span class="meta-footer-thumb">
                                <a href="/about/">
                                    <img class="author-thumb" src="https://www.gravatar.com/avatar/64537dfe80f44978663e378d375c7138?s=150&amp;d=identicon&amp;r=PG" alt="Juri Strumpflohner">
                                </a>
                            </span>
                            <span class="author-meta">
                                <span class="post-name"><a href="/about/">Juri Strumpflohner</a></span><br />
                                <span class="post-date">Jul 28, 2021</span><span class="dot"></span><span
                                    class="post-read">11 min read</span>
                            </span>
                        
                    </div>
                    <div class="col-2">
                        
                        
                        
                        <span class="post-category-icon">
                            
                            
                                <img src="/assets/images/categories/next.svg" />
                            
                        </span>
                        
                        
                    </div>
                </div>
            </div>
        </div>
    </div>

    
</div>

            </div>

            

            <div class="col-md-4">
<div class="card">
    
    <div class="card-block">
        <h2 class="card-title">
            <a href="/blog/2021/07/fast-refresh-mdx-files-next-and-nx">Hot Reload MDX changes in Next.js and Nx</a>
        </h2>
        <h4 class="card-text">
            Learn how to use Next.js, Nx and Tailwind together
            
        </h4>
        <div class="metafooter">
            <div class="wrapfooter">
                <div class="row">
                    <div class="col-10">
                        
                            <span class="meta-footer-thumb">
                                <a href="/about/">
                                    <img class="author-thumb" src="https://www.gravatar.com/avatar/64537dfe80f44978663e378d375c7138?s=150&amp;d=identicon&amp;r=PG" alt="Juri Strumpflohner">
                                </a>
                            </span>
                            <span class="author-meta">
                                <span class="post-name"><a href="/about/">Juri Strumpflohner</a></span><br />
                                <span class="post-date">Jul 15, 2021</span><span class="dot"></span><span
                                    class="post-read">8 min read</span>
                            </span>
                        
                    </div>
                    <div class="col-2">
                        
                        
                        
                        <span class="post-category-icon">
                            
                            
                                <img src="/assets/images/categories/next.svg" />
                            
                        </span>
                        
                        
                    </div>
                </div>
            </div>
        </div>
    </div>

    
</div>

            </div>

            
            

        </div>
    </div>
</div>

<div class="container">
    <div id="comments" class="row justify-content-center mb-5">
        <div class="col-md-8">              
            <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "juristr" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>               
        </div>
    </div>
</div>



<script type="text/javascript" src="//downloads.mailchimp.com/js/signup-forms/popup/unique-methods/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script><script type="text/javascript">window.dojoRequire(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us4.list-manage.com","uuid":"04e83acc0ba14b18f30435204","lid":"1d83b68321","uniqueMethods":true}) })</script>
<div class="container">
    
<div class="footer">
    <p class="pull-left">
        &copy; Copyright Juri Strumpflohner - All rights reserved
    </p>
    <p class="pull-right">
        Customized Mediumish Theme, originally by <a target="_blank" href="https://www.wowthemes.net">WowThemes.net</a>
    </p>
    <div class="clearfix">
    </div>
</div>


</div>

    </div>

<script src="/js/jquery.min.js"></script>


<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-throttle-debounce/1.1/jquery.ba-throttle-debounce.min.js"></script>




<script type="text/javascript" src="/js/bundle.js" integrity=""></script>


<script src="/js/jquery.fluidbox.min.js"></script>
<script>
    $('a.image--zoom,.gallery>a').fluidbox();
</script>

<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-416229-12', 'juristr.com');
    ga('require', 'displayfeatures');
    ga('send', 'pageview');
  </script>






    
    <script type="text/javascript">
        window.cookieconsent_options = {
            "message": "This website uses cookies to ensure you get the best experience on our website",
            "dismiss": "Got it!",
            "learnMore": "More info",
            "link": null,
            "theme": "dark-bottom"
        };
    </script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/1.0.9/cookieconsent.min.js" defer></script>
    

    
    
    
    <script>
!function(t,e,a,c,x){var s='q';t[s]={publication_id:c,tags:x};
var s=e.createElement(a),r=e.getElementsByTagName(a)[0];s.async=1,s.src=
'https://insights.quiet.ly/app/analytics.min.js',r.parentNode.insertBefore(s,r)}
(window,document,'script','87bcee90-0c51-4a68-a60b-e95df730d1ca','[]');
</script>
    
 <script>
    if (window.netlifyIdentity) {
      window.netlifyIdentity.on("init", user => {
        if (!user) {
          window.netlifyIdentity.on("login", () => {
            document.location.href = "/admin/";
          });
        }
      });
    }
  </script>
</body>

</html>
