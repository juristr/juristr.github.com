<!DOCTYPE html>
<html lang="en-us"><head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="generator" content="Hugo 0.53" />
	
	<link rel="shortcut icon" href="/assets/images/sitelogo.jpeg">
	
	<title>Display Server Side Validation Errors with Angular | juri.strumpflohner</title>
	
	<meta name="description" content="Binding server validation errors to your Angular form">
	
	
	<meta name="robots" content="index, follow">

	
	<meta name="author" content="Juri Strumpflohner">
	<link rel="me" href="https://profiles.google.com/104904743888756261987" />
	<link rel="publisher" href='https://plus.google.com/104904743888756261987' />
	<meta property="twitter:account_id" content="14407063" />


	
	<meta name="google-site-verification" content="0_vyoIaeMG1kXR0h-48gy3OaGl8xoiSJsFDxxCTIBMs" />
	<meta name="google-site-verification" content="AvmssSjl_nchNXIqBW8Agb_UjGqvvLP7HXSxBZ9d0cg" />

	
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:site" content="@juristr" />
	<meta name="twitter:title" content="Display Server Side Validation Errors with Angular" />
	
	<meta name="twitter:description" content="Binding server validation errors to your Angular form" />
	

	
	<meta name="twitter:image:src" content="https://juristr.com/blog/assets/imgs/server-side-validation-errors.png" />
	

	
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Display Server Side Validation Errors with Angular" />
	
	<meta property="og:description" content="Binding server validation errors to your Angular form" />
	
	
	<meta property="og:image" content="https://juristr.com/blog/assets/imgs/server-side-validation-errors.png" />
	
	<meta property="og:url" content="https://juristr.com/blog/2019/02/display-server-side-validation-errors-with-angular" />
	<meta property="og:site_name" content="juristr.com" />

	
	<link rel="alternate" type="application/rss+xml" title="Juri Strumpflohner" href="//feeds.feedburner.com/juristrumpflohner">
	

	
	<link href="/css/bootstrap.min.css" rel="stylesheet">

	
	
	<link href='//fonts.googleapis.com/css?family=Righteous|Roboto:400,700,900|Source+Code+Pro|Lora:400,700,400italic|Material+Icons'
	 rel='stylesheet' type='text/css'>
	

	

	
	
	
	<link rel="stylesheet" href="/scss/main.min.css" integrity="" media="screen">

	

	

	
	
	<link rel="stylesheet" href="/scss/article.min.css" integrity="" media="screen">
	

	
	
</head><body>
<header class="navbar-light bg-white fixed-top mediumnavigation nav-down">
    <div class="container">

        
        <div class="row justify-content-center align-items-center brandrow">

            <div class="col-lg-4 col-md-4 col-xs-12 d-none d-md-block hidden-xs customarea">
                <img src="/assets/images/gde.svg" style="height:23px">
                <a href="https://google-developers.appspot.com/community/experts/directory/profile/profile-juri_strumpflohner" style="
                    padding-left: 5px;
                    font-size: 15pt;
                ">GDE
                    for Web Tech</a>
                

            </div>

            <div class="col-lg-4 col-md-4  col-xs-12 text-center logoarea">
                <a class="navbar-brand" href="https://juristr.com/">
                    
                    <span style="font-family:Righteous;">juri.strumpflohner</span>
                    
                </a>
                
            </div>

            <div class="col-lg-4 col-md-4  col-xs-12 text-right d-none d-md-block">
                <a href="https://twitter.com/juristr" class="twitter-follow-button" data-show-count="true">Follow me!</a>
                <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
            </div>

        </div>
        

        <div class="navarea">

            <nav class="navbar navbar-toggleable-sm">
                
                <div id="bs4navbar" class="navbar-collapse">
                    
                    <ul id="menu-top-menu" class="navbar-nav col-md-12 justify-content-center">
                        
                        <li class="menu-item ">
                            <a class="nav-link" href="/">Home</a>
                        </li>
                        
                        <li class="menu-item ">
                            <a class="nav-link" href="/blog">Blog</a>
                        </li>
                        
                        <li class="menu-item ">
                            <a class="nav-link" href="/categories">Collections</a>
                        </li>
                        
                        <li class="menu-item ">
                            <a class="nav-link" href="/newsletter">Newsletter</a>
                        </li>
                        
                        <li class="menu-item ">
                            <a class="nav-link" href="https://github.com/juristr/ama">AMA</a>
                        </li>
                        
                        <li class="menu-item ">
                            <a class="nav-link" href="/about">About Me</a>
                        </li>
                        
                    </ul>

                    
                </div>
            </nav>

        </div>

    </div>

</header>

    <div class="site-content">



<div class="container page-container">
    <div class="row">
        
        <div class="col-md-2 pl-0"><div class="share">
    <p>
        Share
    </p>
    <ul>
        <li>
            <a target="_blank" href="https://twitter.com/home?status=Check out this post by @juristr https%3a%2f%2fjuristr.com%2fblog%2f2019%2f02%2fdisplay-server-side-validation-errors-with-angular%2f">
                <svg class="svgIcon-use" width="29" height="29" viewbox="0 0 29 29">
                    <path d="M21.967 11.8c.018 5.93-4.607 11.18-11.177 11.18-2.172 0-4.25-.62-6.047-1.76l-.268.422-.038.5.186.013.168.012c.3.02.44.032.6.046 2.06-.026 3.95-.686 5.49-1.86l1.12-.85-1.4-.048c-1.57-.055-2.92-1.08-3.36-2.51l-.48.146-.05.5c.22.03.48.05.75.08.48-.02.87-.07 1.25-.15l2.33-.49-2.32-.49c-1.68-.35-2.91-1.83-2.91-3.55 0-.05 0-.01-.01.03l-.49-.1-.25.44c.63.36 1.35.57 2.07.58l1.7.04L7.4 13c-.978-.662-1.59-1.79-1.618-3.047a4.08 4.08 0 0 1 .524-1.8l-.825.07a12.188 12.188 0 0 0 8.81 4.515l.59.033-.06-.59v-.02c-.05-.43-.06-.63-.06-.87a3.617 3.617 0 0 1 6.27-2.45l.2.21.28-.06c1.01-.22 1.94-.59 2.73-1.09l-.75-.56c-.1.36-.04.89.12 1.36.23.68.58 1.13 1.17.85l-.21-.45-.42-.27c-.52.8-1.17 1.48-1.92 2L22 11l.016.28c.013.2.014.35 0 .52v.04zm.998.038c.018-.22.017-.417 0-.66l-.498.034.284.41a8.183 8.183 0 0 0 2.2-2.267l.97-1.48-1.6.755c.17-.08.3-.02.34.03a.914.914 0 0 1-.13-.292c-.1-.297-.13-.64-.1-.766l.36-1.254-1.1.695c-.69.438-1.51.764-2.41.963l.48.15a4.574 4.574 0 0 0-3.38-1.484 4.616 4.616 0 0 0-4.61 4.613c0 .29.02.51.08.984l.01.02.5-.06.03-.5c-3.17-.18-6.1-1.7-8.08-4.15l-.48-.56-.36.64c-.39.69-.62 1.48-.65 2.28.04 1.61.81 3.04 2.06 3.88l.3-.92c-.55-.02-1.11-.17-1.6-.45l-.59-.34-.14.67c-.02.08-.02.16 0 .24-.01 2.12 1.55 4.01 3.69 4.46l.1-.49-.1-.49c-.33.07-.67.12-1.03.14-.18-.02-.43-.05-.64-.07l-.76-.09.23.73c.57 1.84 2.29 3.14 4.28 3.21l-.28-.89a8.252 8.252 0 0 1-4.85 1.66c-.12-.01-.26-.02-.56-.05l-.17-.01-.18-.01L2.53 21l1.694 1.07a12.233 12.233 0 0 0 6.58 1.917c7.156 0 12.2-5.73 12.18-12.18l-.002.04z"></path>
                </svg>
            </a>
        </li>
        <li>
            <a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fjuristr.com%2fblog%2f2019%2f02%2fdisplay-server-side-validation-errors-with-angular%2f">
                <svg class="svgIcon-use" width="29" height="29" viewbox="0 0 29 29">
                    <path d="M16.39 23.61v-5.808h1.846a.55.55 0 0 0 .546-.48l.36-2.797a.551.551 0 0 0-.547-.62H16.39V12.67c0-.67.12-.813.828-.813h1.474a.55.55 0 0 0 .55-.55V8.803a.55.55 0 0 0-.477-.545c-.436-.06-1.36-.116-2.22-.116-2.5 0-4.13 1.62-4.13 4.248v1.513H10.56a.551.551 0 0 0-.55.55v2.797c0 .304.248.55.55.55h1.855v5.76c-4.172-.96-7.215-4.7-7.215-9.1 0-5.17 4.17-9.36 9.31-9.36 5.14 0 9.31 4.19 9.31 9.36 0 4.48-3.155 8.27-7.43 9.15M14.51 4C8.76 4 4.1 8.684 4.1 14.46c0 5.162 3.75 9.523 8.778 10.32a.55.55 0 0 0 .637-.543v-6.985a.551.551 0 0 0-.55-.55H11.11v-1.697h1.855a.55.55 0 0 0 .55-.55v-2.063c0-2.02 1.136-3.148 3.03-3.148.567 0 1.156.027 1.597.06v1.453h-.924c-1.363 0-1.93.675-1.93 1.912v1.78c0 .3.247.55.55.55h2.132l-.218 1.69H15.84c-.305 0-.55.24-.55.55v7.02c0 .33.293.59.623.54 5.135-.7 9.007-5.11 9.007-10.36C24.92 8.68 20.26 4 14.51 4"></path>
                </svg>
            </a>
        </li>
    </ul>
    
</div></div>
        
        <div class="col-md-9 col-md-offset-2 col-xs-12">
            <div class="mainheading">

                
                
                
                
                <div class="row post-top-meta">
                    
                    <div class="col-md-2">
                        <img class="author-thumb" src="https://www.gravatar.com/avatar/64537dfe80f44978663e378d375c7138?s=150&amp;d=identicon&amp;r=PG" alt="Juri Strumpflohner">
                    </div>
                    <div class="col-md-10">
                        <a class="link-dark" href="/about/">Juri Strumpflohner</a><a href="https://twitter.com/@juristr"
                            class="btn follow">Follow</a>
                        <span class="author-description">Juri is a full stack developer and tech lead with a special passion for the web and frontend development. He creates online videos for <a href="https://egghead.io/instructors/juri-strumpflohner">Egghead.io</a>, writes articles on his blog and for tech magazines, speaks at conferences and holds training workshops.</span>
                        
                    </div>
                    
                </div>
                
                
                
                

                <h1 class="posttitle">Display Server Side Validation Errors with Angular</h1>
                
                <h2 class="article-subtitle">Binding server validation errors to your Angular form</h2>
                
                <p>
                    <span class="post-date">
                        <time class="post-date">
                            Feb 7, 2019
                        </time></span>
                    <span class="dot"></span>
                    <span class="post-read">8 min read</span>
                </p>
            </div>

            
            
            

            
            <a href="https://egghead.io/courses/productive-git-for-developers" class="external-link" data-client="eggheadio" data-uid="url">
                <img src="/assets/images/banners/egghead-banner-productive-git.png" style="width:100%" />
            </a>
            

            
            <div class="article-post">
                <div class="article-intro">
    Input Validation is a big topic when it comes to forms. And even more in those large, enterprisey apps, where validation can become really crazy. Now, Angular forms of course provide different mechanisms for handling validation out of the box. However, in this article I won&rsquo;t go into those details, I will rather show you a possible strategy for visualizing server side validation errors.
</div>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9669473064376287" data-ad-slot="2496274486"
    data-ad-format="auto"></ins>
<script>
    (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<p>Before starting straight away, we can basically have these types of validation:</p>

<ul>
<li><strong>client-side -</strong> they prevent you even from submitting the form itself. The simplest for sure being the required validator, or others like checking the max length etc.</li>
<li><strong>client-side async -</strong> typical use case: checking for the availability of the username. By using an async validator, we can call a function on the server via an API to verify whether the user provided value (in this case the username) has not already been taken. Aside from the difference that we call a server API, the behavior is quite similar. Unless the validator is satisfied, we won&rsquo;t be able to submit our form.</li>
</ul>

<p>Sometimes however, we <strong>have to submit the form</strong> to be able to perform more cross-cutting validation logic. We might need to take the data combine it with other data (from the DB) we only have available on the server side, before ultimately then returning either a success status or fail due to &ldquo;validation errors&rdquo;. Such validation errors can then be targeted to a single field (i.e. the username field) or even the entire entity (or user model).</p>

<h2 id="tl-dr">TL;DR</h2>

<p>Might want to watch the according <a href="https://egghead.io/lessons/egghead-display-a-server-side-validation-error-response-onto-an-angular-form">Egghead.io lesson</a> then üòâ&hellip;</p>

<div class="egghead-video-embed">
    <iframe src="https://egghead.io/lessons/egghead-display-a-server-side-validation-error-response-onto-an-angular-form/embed" width="100%" height="500px"> </iframe>
    <a href="https://egghead.io/lessons/egghead-display-a-server-side-validation-error-response-onto-an-angular-form" class="external-link" data-client="eggheadio" data-uid="lessons/egghead-display-a-server-side-validation-error-response-onto-an-angular-form">View
        on
        Egghead.io</a>
</div>

<h2 id="http-and-status-codes">HTTP and Status Codes</h2>

<p>In modern APIs, whenever we send data to the server and it gets processed successfully, an <code>HTTP 200</code> response is being sent back to confirm the success. We might even get the data back in the response body, containing additional fields that might have been calculated on the server side. A classic example: the primary key property (usually) <code>id</code> might have been populated on the server side.</p>

<p>Similarly, when something goes terribly wrong, we get an <code>HTTP 500</code>. That&rsquo;s usually a server error, where the user cannot really do something about it, in terms of modifying the submitted data. It&rsquo;s usually due to a server outage, configuration or even programming issue.</p>

<p>Aside from a <code>HTTP 500</code> we might also have a different error scenario, one that <strong>depends on the submitted data</strong>. Let&rsquo;s take the &ldquo;username&rdquo; example. I know we could easily solve this via an async validator, but let&rsquo;s assume for now we have to submit the form first and it will be evaluated on the server side. Now if the username is already taken, the server has to communicate that somehow to the client s.t. that one in turn can communicate it to the user and ask him/her to change it.</p>

<p>One might now be tempted to return a <code>HTTP 200</code> and within the response body provide some information that illustrates the issue. I&rsquo;ve seen people do something like</p>
<div class="highlight"><pre class="chroma"><code class="language-json" data-lang="json"><span class="err">//</span> <span class="err">DON&#39;T</span>
<span class="err">//</span> <span class="err">positive</span> <span class="err">response</span> <span class="err">(HTTP</span> <span class="mi">200</span><span class="err">)</span>
<span class="p">{</span>
  <span class="err">status:</span> <span class="err">&#39;OK&#39;,</span>
  <span class="err">data:</span> <span class="err">{</span>
    <span class="err">...</span>
  <span class="p">}</span>
<span class="err">}</span></code></pre></div><div class="highlight"><pre class="chroma"><code class="language-json" data-lang="json"><span class="err">//</span> <span class="err">DON&#39;T</span>
<span class="err">//</span> <span class="err">negative</span> <span class="err">response</span> <span class="err">(still</span> <span class="err">HTTP</span> <span class="mi">200</span><span class="err">)</span>
<span class="p">{</span>
  <span class="err">status:</span> <span class="err">&#39;ERROR&#39;,</span>
  <span class="err">errors:</span> <span class="err">{</span>
    <span class="err">...</span>
  <span class="p">}</span>
<span class="err">}</span></code></pre></div>
<p>You can see how the <code>status</code> field in the response is being used to determine whether the request was successful or not. Such an approach is discouraged however. While the structuring of the data in the response body is totally fine (and up to you, even placing the <code>status</code> property), don&rsquo;t use status fields for determining whether the request is a success or failure. Rather <strong>make use the HTTP status code instead</strong>!</p>

<h2 id="communicate-validation-errors-via-http">Communicate validation errors via HTTP</h2>

<p>What status code should we use for validation errors? Is it a 500 (server error)? 400 (bad request)? <code>500</code> is more like a server side issue, so that&rsquo;s probably &ldquo;wrong&rdquo;. Let&rsquo;s check <code>400 - Bad Request</code>:</p>

<blockquote>
<p>The 400 (Bad Request) status code indicates that the server cannot or will not process the request due to something that is perceived to be a client error (e.g., malformed request syntax, invalid request message framing, or deceptive request routing). <cite><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1" target="_blank"><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">https://tools.ietf.org/html/rfc7231#section-6.5.1</a></a></cite></p>
</blockquote>

<p>That looks better. However &ldquo;malformed request syntax&rdquo; and &ldquo;invalid request message framing&rdquo; doesn&rsquo;t quite match it.</p>

<p>I&rsquo;m usually using <code>422 - Unprocessable Entity</code> instead. The definition says the following:</p>

<blockquote>
<p>The 422 (Unprocessable Entity) status code means the server understands the content type of the request entity (hence a 415 (Unsupported Media Type) status code is inappropriate), and the syntax of the request entity is correct (thus a 400 (Bad Request) status code is inappropriate) but was unable to process the contained instructions.  For example, this error condition may occur if an XML request body contains well-formed (i.e., syntactically correct), but semantically erroneous, XML instructions. <cite><a href="https://tools.ietf.org/html/rfc4918#section-11.2" target="_blank"><a href="https://tools.ietf.org/html/rfc4918#section-11.2">https://tools.ietf.org/html/rfc4918#section-11.2</a></a></cite></p>
</blockquote>

<p>I think it best matches our needs. Having defined the status code, we need to determine how to best transport the information back to the client? Well, here it really depends on the type of information you have. If we&rsquo;re able to directly associate the error to a form input property, the response could look as follows:</p>
<div class="highlight"><pre class="chroma"><code class="language-json" data-lang="json"><span class="err">//</span> <span class="err">HTTP</span> <span class="mi">422</span> <span class="err">body</span>
<span class="p">{</span>
  <span class="err">errors:</span> <span class="err">{</span>
    <span class="nt">&#34;username&#34;</span><span class="p">:</span> <span class="s2">&#34;The username is already taken&#34;</span>
  <span class="p">}</span>
<span class="err">}</span></code></pre></div>
<p><em>(Note, this is just an example. The choice of using an object rather than an array here is just mine, you can totally define this response by yourself)</em></p>

<h2 id="visualizing-server-side-validation-errors">Visualizing server side validation errors</h2>

<p>We now know the HTTP status and the transport format. What&rsquo;s left is how to map this onto the client-form, which isn&rsquo;t too difficult after all. The strategy is the following:</p>

<ul>
<li>check whether the HTTP status is 422</li>
<li>for each entry in the <code>errors</code> object, try to match a form field and invalidate it</li>
</ul>

<p>Let&rsquo;s implement it. Consider our form to be as simple as the following:</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">form</span> <span class="err">...</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">mat-form-field</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">matInput</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&#34;Username&#34;</span> <span class="na">formControlName</span><span class="o">=</span><span class="s">&#34;username&#34;</span> <span class="na">required</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">mat-error</span> <span class="err">*</span><span class="na">ngIf</span><span class="o">=</span><span class="s">&#34;form.get(&#39;username&#39;).errors?.required&#34;</span><span class="p">&gt;</span>Username is required<span class="p">&lt;/</span><span class="nt">mat-error</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">mat-form-field</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span></code></pre></div>
<p>As you can see there is a required validator and the according <code>&lt;mat-error&gt;</code> (I&rsquo;m using <a href="https://material.angular.io/">Angular Material</a> here) that&rsquo;s responsible for visualizing the error. The <code>required</code> fires immediately, and won&rsquo;t let us submit the form unless it is valid.</p>

<h3 id="validation-error-placeholder-for-server-validation-errors">Validation error placeholder for server validation errors</h3>

<p>In order to be able to visualize the server-side error messages, we also need a placeholder for visualizing the error message:</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">form</span> <span class="err">...</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">mat-form-field</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">matInput</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&#34;Username&#34;</span> <span class="na">formControlName</span><span class="o">=</span><span class="s">&#34;username&#34;</span> <span class="na">required</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">mat-error</span> <span class="err">*</span><span class="na">ngIf</span><span class="o">=</span><span class="s">&#34;form.get(&#39;username&#39;).errors?.required&#34;</span><span class="p">&gt;</span>Username is required<span class="p">&lt;/</span><span class="nt">mat-error</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- server-side validation errors --&gt;</span>
    <span class="p">&lt;</span><span class="nt">mat-error</span> <span class="err">*</span><span class="na">ngIf</span><span class="o">=</span><span class="s">&#34;form.get(&#39;username&#39;).errors?.serverError&#34;</span><span class="p">&gt;</span>
      {{ form.get(&#39;username&#39;).errors?.serverError }}
    <span class="p">&lt;/</span><span class="nt">mat-error</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">mat-form-field</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span></code></pre></div>
<p>As you can see, whenever the <code>username</code> field has errors of type <code>serverError</code>, this new validation error message gets shown and visualizes the text inside the <code>...errors.serverError</code> property.</p>

<h3 id="parsing-the-error-and-activating-the-validation-message">Parsing the error and activating the validation message</h3>

<p>The part that&rsquo;s missing is to parse the error. Assume we have a <code>personService</code> that sends the form value back to the server via some HTTP API. In the <code>subscribe</code>, we implement the error callback and check for an <code>HttpErrorResponse</code> as well as our <code>422</code> status code.</p>
<div class="highlight"><pre class="chroma"><code class="language-typescript" data-lang="typescript"><span class="k">this</span><span class="p">.</span><span class="nx">personService</span><span class="p">.</span><span class="nx">save</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span>
    <span class="p">...</span>
  <span class="p">)</span>
  <span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Successfully saved person&#39;</span><span class="p">,</span> <span class="nx">x</span><span class="p">);</span>
  <span class="p">},</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span> <span class="k">instanceof</span> <span class="nx">HttpErrorResponse</span><span class="p">)</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="nx">errorMessages</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="o">&lt;</span><span class="p">{</span> <span class="nx">propName</span>: <span class="kt">string</span><span class="p">;</span> <span class="nx">errors</span>: <span class="kt">string</span> <span class="p">}</span><span class="o">&gt;</span><span class="p">();</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="mi">422</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// TODO: extract errors here and match onto the form
</span><span class="c1"></span>      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">})</span></code></pre></div>
<p>In such case, we can now parse the error messages based on the response structure we defined earlier. Whenever we get a matching form field, we activate the <code>serverError</code> validation message using the <code>setErrors(..)</code> function of the <code>FormControl</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-typescript" data-lang="typescript"><span class="p">...</span>
<span class="k">if</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="mi">422</span><span class="p">)</span> <span class="p">{</span>
  <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">validationErrors</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">prop</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">formControl</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">prop</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">formControl</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// activate the error message
</span><span class="c1"></span>      <span class="nx">formControl</span><span class="p">.</span><span class="nx">setErrors</span><span class="p">({</span>
        <span class="nx">serverError</span>: <span class="kt">validationErrors</span><span class="p">[</span><span class="nx">prop</span><span class="p">]</span>
      <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">}</span></code></pre></div>
<h2 id="what-about-unmatched-errors">What about unmatched errors?</h2>

<p>For simplicity reasons, I didn&rsquo;t implement any fallback mechanism here, but you definitely should! There might be situations where you cannot find any matching form field, simply because the property is not shown, the field might be hidden to the user etc. For such scenarios, it is considered good practice to visualize an error notification to the user with all those error messages.</p>

<p>In general it is a good usability practice to show <em>all</em> of the error messages in some type of alert/notification, in addition to trying to match them onto the form directly.</p>

<h2 id="running-stackblitz-example">Running Stackblitz Example</h2>

<p>Finally, here&rsquo;s a running Stackblitz example, made with ‚ù§Ô∏è for you to play around with üòâ. Note, since I don&rsquo;t have an HTTP server on Stackblitz, I simulate the HTTP calls/responses with some RxJS and delays üòÖ</p>

<iframe src="https://stackblitz.com//edit/blog-server-side-validation-display?ctl=1&embed=1" width="100%" height="500px"> </iframe>

<h2 id="conclusion-and-considerations">Conclusion and Considerations</h2>

<p>Here are some final considerations. First of all, this approach definitely requires some &ldquo;coupling&rdquo; between the client form and the server response model as the properties obviously have to match. This is something that might not always be the case, whether it&rsquo;s due to the usage of DTOs (Data Transfer Objects) that get remapped onto client-side entities or for whatever reason. In such cases, applying such strategy gets more difficult, as also the error message would have to be re-mapped accordingly. It is possible but requires some more manual work.</p>

<p>Furthermore, since the server returns the error messages, they have to be localized in the user language. That requires that the language on the client and server side is synced. It&rsquo;s not necessary to keep a session (which I&rsquo;d avoid if possible), but you could simply send the user language along as a HTTP header (for instance).<br />
Alternatively, just return some &ldquo;error code&rdquo; that gets interpreted and mapped to some localized message on the client. Whatever fits you best üòÉ</p>

<p><strong>Have a better solution?</strong> This is definitely not a golden hammer! I&rsquo;d love to hear about it!</p>

				<hr />

				Questions? Thoughts? Hit me up <a href="https://twitter.com/juristr" target="_blank">on Twitter</a>
            </div>

            
            <div class="after-post-tags">
                <ul class="tags">
                    
                    <li>
                        <a href="/tags/angular">angular</a>
                    </li>
                    
                    <li>
                        <a href="/tags/forms">forms</a>
                    </li>
                    
                    <li>
                        <a href="/tags/validation">validation</a>
                    </li>
                    
                    <li>
                        <a href="/tags/egghead">egghead</a>
                    </li>
                    
                    <li>
                        <a href="/tags/videos">videos</a>
                    </li>
                    
                </ul>
            </div>
            

            <a href="https://egghead.io/instructors/juri-strumpflohner" class="external-link" data-client="eggheadio"
                data-uid="egghead-instructor-page">
                <img src="/blog/assets/imgs/egghead-banner-learn-with-me.png" style="width:100%" />
            </a>

            
            
            
        </div>
        
    </div>
</div>

<div class="hideshare"></div>



<div class="related-container">
    <div class="container">
        <div class="row listrecent listrelated">
            
            

            <div class="col-md-4">
<div class="card">
    
    <div class="card-block">
        <h2 class="card-title">
            <a href="/blog/2018/10/simple-state-management-with-scan">Simple State Management with RxJS‚Äôs scan operator</a>
        </h2>
        <h4 class="card-text">
            Learn how you can build your own simple state management with just RxJS
            
        </h4>
        <div class="metafooter">
            <div class="wrapfooter">
                <div class="row">
                    <div class="col-10">
                        
                            <span class="meta-footer-thumb">
                                <a href="/about/">
                                    <img class="author-thumb" src="https://www.gravatar.com/avatar/64537dfe80f44978663e378d375c7138?s=150&amp;d=identicon&amp;r=PG" alt="Juri Strumpflohner">
                                </a>
                            </span>
                            <span class="author-meta">
                                <span class="post-name"><a href="/about/">Juri Strumpflohner</a></span><br />
                                <span class="post-date">Oct 10, 2018</span><span class="dot"></span><span
                                    class="post-read">4 min read</span>
                            </span>
                        
                    </div>
                    <div class="col-2">
                        
                        
                        
                        <span class="post-category-icon">
                            
                            
                                <img src="/assets/images/categories/rxjs.svg" />
                            
                        </span>
                        
                        
                    </div>
                </div>
            </div>
        </div>
    </div>

    
</div>

            </div>

            
            

        </div>
    </div>
</div>

<div class="container">
    <div id="comments" class="row justify-content-center mb-5">
        <div class="col-md-8">              
            <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "juristr" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>               
        </div>
    </div>
</div>



<script type="text/javascript" src="//downloads.mailchimp.com/js/signup-forms/popup/unique-methods/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script><script type="text/javascript">window.dojoRequire(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us4.list-manage.com","uuid":"04e83acc0ba14b18f30435204","lid":"1d83b68321","uniqueMethods":true}) })</script>
<div class="container">
    
<div class="footer">
    <p class="pull-left">
        &copy; Copyright Juri Strumpflohner - All rights reserved
    </p>
    <p class="pull-right">
        Customized Mediumish Theme, originally by <a target="_blank" href="https://www.wowthemes.net">WowThemes.net</a>
    </p>
    <div class="clearfix">
    </div>
</div>


</div>

    </div>

<script src="/js/jquery.min.js"></script>


<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-throttle-debounce/1.1/jquery.ba-throttle-debounce.min.js"></script>




<script type="text/javascript" src="/js/bundle.js" integrity=""></script>


<script src="/js/jquery.fluidbox.min.js"></script>
<script>
    $('a.image--zoom,.gallery>a').fluidbox();
</script>

<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-416229-12', 'juristr.com');
    ga('require', 'displayfeatures');
    ga('send', 'pageview');
  </script>






    
    <script type="text/javascript">
        window.cookieconsent_options = {
            "message": "This website uses cookies to ensure you get the best experience on our website",
            "dismiss": "Got it!",
            "learnMore": "More info",
            "link": null,
            "theme": "dark-bottom"
        };
    </script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/1.0.9/cookieconsent.min.js"></script>
    

    
    
</body>

</html>