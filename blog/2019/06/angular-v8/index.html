<!DOCTYPE html>
<html lang="en-us"><head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="generator" content="Hugo 0.53" />
	
	<link rel="shortcut icon" href="/assets/images/sitelogo.jpeg">
	
	<title>Update to Angular Version 8 now! | juri.dev</title>
	
	<meta name="description" content="What&#39;s new in Angular v8, how to update and what to watch out for">
	
	
	<meta name="robots" content="index, follow">

	
	<meta name="author" content="Juri Strumpflohner">
	<link rel="me" href="https://profiles.google.com/104904743888756261987" />
	<link rel="publisher" href='https://plus.google.com/104904743888756261987' />
	<meta property="twitter:account_id" content="14407063" />


	
	<meta name="google-site-verification" content="0_vyoIaeMG1kXR0h-48gy3OaGl8xoiSJsFDxxCTIBMs" />
	<meta name="google-site-verification" content="AvmssSjl_nchNXIqBW8Agb_UjGqvvLP7HXSxBZ9d0cg" />

	
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:site" content="@juristr" />
	<meta name="twitter:creator" content="@juristr" />
	<meta name="twitter:title" content="Update to Angular Version 8 now!" />
	
	<meta name="twitter:description" content="What&#39;s new in Angular v8, how to update and what to watch out for" />
	

	
	<meta name="twitter:image:src" content="https://juristr.com/blog/assets/imgs/ng-v8-upgrade.jpg" />
	

	
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Update to Angular Version 8 now!" />
	
	<meta property="og:description" content="What&#39;s new in Angular v8, how to update and what to watch out for" />
	
	
	<meta property="og:image" content="https://juristr.com/blog/assets/imgs/ng-v8-upgrade.jpg" />
	
	<meta property="og:url" content="https://juristr.com/blog/2019/06/angular-v8" />
	<meta property="og:site_name" content="juristr.com" />

	

	
	<link rel="alternate" type="application/rss+xml" title="Juri Strumpflohner" href="//feeds.feedburner.com/juristrumpflohner">
	

	
	<link href="/css/bootstrap.min.css" rel="stylesheet">

	
	
	<link href='//fonts.googleapis.com/css?family=Righteous|Roboto:400,700,900|Source+Code+Pro|Lora:400,700,400italic|Material+Icons'
	 rel='stylesheet' type='text/css'>
	

	

	
	
	
	<link rel="stylesheet" href="/scss/main.min.css" integrity="" media="screen">

	

	

	
	
	<link rel="stylesheet" href="/scss/article.min.css" integrity="" media="screen">
	

	
	
	<script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>
<body>
<header class="navbar-light bg-white fixed-top mediumnavigation nav-down">
    <div class="container">

        
        <div class="row justify-content-center align-items-center brandrow">

            <div class="col-lg-4 col-md-4 col-xs-12 d-none d-md-block hidden-xs customarea">
                <img src="/assets/images/gde.svg" style="height:23px">
                <a href="https://developers.google.com/community/experts/directory/profile/profile-juri_strumpflohner" style="
                    padding-left: 5px;
                    font-size: 15pt;
                ">GDE
                    for Web Tech</a>
                

            </div>

            <div class="col-lg-4 col-md-4  col-xs-12 text-center logoarea">
                <a class="navbar-brand" href="https://juristr.com/">
                    
                    <span style="font-family:Righteous;">juri.dev</span>
                    
                </a>
                
            </div>

            <div class="col-lg-4 col-md-4  col-xs-12 text-right d-none d-md-block">
                <a href="https://twitter.com/juristr" class="twitter-follow-button" data-show-count="true">Follow me!</a>
                <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
            </div>

        </div>
        

        <div class="navarea">

            <nav class="navbar navbar-toggleable-sm">
                
                <div id="bs4navbar" class="navbar-collapse">
                    
                    <ul id="menu-top-menu" class="navbar-nav col-md-12 justify-content-center">
                        
                        <li class="menu-item ">
                            <a class="nav-link" href="/">Home</a>
                        </li>
                        
                        <li class="menu-item ">
                            <a class="nav-link" href="/blog">Blog</a>
                        </li>
                        
                        <li class="menu-item ">
                            <a class="nav-link" href="/categories">Collections</a>
                        </li>
                        
                        <li class="menu-item ">
                            <a class="nav-link" href="/newsletter">Newsletter</a>
                        </li>
                        
                        <li class="menu-item ">
                            <a class="nav-link" href="https://github.com/juristr/ama">AMA</a>
                        </li>
                        
                        <li class="menu-item ">
                            <a class="nav-link" href="/about">About Me</a>
                        </li>
                        
                    </ul>

                    
                </div>
            </nav>

        </div>

    </div>

</header>

    <div class="site-content">



<div class="container page-container">
    <div class="row">
        
        <div class="col-md-2 pl-0"><div class="share">
    <p>
        Share
    </p>
    <ul>
        <li>
            <a target="_blank" href="https://twitter.com/home?status=Check out this post by @juristr https%3a%2f%2fjuristr.com%2fblog%2f2019%2f06%2fangular-v8%2f">
                <svg class="svgIcon-use" width="29" height="29" viewbox="0 0 29 29">
                    <path d="M21.967 11.8c.018 5.93-4.607 11.18-11.177 11.18-2.172 0-4.25-.62-6.047-1.76l-.268.422-.038.5.186.013.168.012c.3.02.44.032.6.046 2.06-.026 3.95-.686 5.49-1.86l1.12-.85-1.4-.048c-1.57-.055-2.92-1.08-3.36-2.51l-.48.146-.05.5c.22.03.48.05.75.08.48-.02.87-.07 1.25-.15l2.33-.49-2.32-.49c-1.68-.35-2.91-1.83-2.91-3.55 0-.05 0-.01-.01.03l-.49-.1-.25.44c.63.36 1.35.57 2.07.58l1.7.04L7.4 13c-.978-.662-1.59-1.79-1.618-3.047a4.08 4.08 0 0 1 .524-1.8l-.825.07a12.188 12.188 0 0 0 8.81 4.515l.59.033-.06-.59v-.02c-.05-.43-.06-.63-.06-.87a3.617 3.617 0 0 1 6.27-2.45l.2.21.28-.06c1.01-.22 1.94-.59 2.73-1.09l-.75-.56c-.1.36-.04.89.12 1.36.23.68.58 1.13 1.17.85l-.21-.45-.42-.27c-.52.8-1.17 1.48-1.92 2L22 11l.016.28c.013.2.014.35 0 .52v.04zm.998.038c.018-.22.017-.417 0-.66l-.498.034.284.41a8.183 8.183 0 0 0 2.2-2.267l.97-1.48-1.6.755c.17-.08.3-.02.34.03a.914.914 0 0 1-.13-.292c-.1-.297-.13-.64-.1-.766l.36-1.254-1.1.695c-.69.438-1.51.764-2.41.963l.48.15a4.574 4.574 0 0 0-3.38-1.484 4.616 4.616 0 0 0-4.61 4.613c0 .29.02.51.08.984l.01.02.5-.06.03-.5c-3.17-.18-6.1-1.7-8.08-4.15l-.48-.56-.36.64c-.39.69-.62 1.48-.65 2.28.04 1.61.81 3.04 2.06 3.88l.3-.92c-.55-.02-1.11-.17-1.6-.45l-.59-.34-.14.67c-.02.08-.02.16 0 .24-.01 2.12 1.55 4.01 3.69 4.46l.1-.49-.1-.49c-.33.07-.67.12-1.03.14-.18-.02-.43-.05-.64-.07l-.76-.09.23.73c.57 1.84 2.29 3.14 4.28 3.21l-.28-.89a8.252 8.252 0 0 1-4.85 1.66c-.12-.01-.26-.02-.56-.05l-.17-.01-.18-.01L2.53 21l1.694 1.07a12.233 12.233 0 0 0 6.58 1.917c7.156 0 12.2-5.73 12.18-12.18l-.002.04z"></path>
                </svg>
            </a>
        </li>
        <li>
            <a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fjuristr.com%2fblog%2f2019%2f06%2fangular-v8%2f">
                <svg class="svgIcon-use" width="29" height="29" viewbox="0 0 29 29">
                    <path d="M16.39 23.61v-5.808h1.846a.55.55 0 0 0 .546-.48l.36-2.797a.551.551 0 0 0-.547-.62H16.39V12.67c0-.67.12-.813.828-.813h1.474a.55.55 0 0 0 .55-.55V8.803a.55.55 0 0 0-.477-.545c-.436-.06-1.36-.116-2.22-.116-2.5 0-4.13 1.62-4.13 4.248v1.513H10.56a.551.551 0 0 0-.55.55v2.797c0 .304.248.55.55.55h1.855v5.76c-4.172-.96-7.215-4.7-7.215-9.1 0-5.17 4.17-9.36 9.31-9.36 5.14 0 9.31 4.19 9.31 9.36 0 4.48-3.155 8.27-7.43 9.15M14.51 4C8.76 4 4.1 8.684 4.1 14.46c0 5.162 3.75 9.523 8.778 10.32a.55.55 0 0 0 .637-.543v-6.985a.551.551 0 0 0-.55-.55H11.11v-1.697h1.855a.55.55 0 0 0 .55-.55v-2.063c0-2.02 1.136-3.148 3.03-3.148.567 0 1.156.027 1.597.06v1.453h-.924c-1.363 0-1.93.675-1.93 1.912v1.78c0 .3.247.55.55.55h2.132l-.218 1.69H15.84c-.305 0-.55.24-.55.55v7.02c0 .33.293.59.623.54 5.135-.7 9.007-5.11 9.007-10.36C24.92 8.68 20.26 4 14.51 4"></path>
                </svg>
            </a>
        </li>
    </ul>
    
</div></div>
        
        <div class="col-md-9 col-md-offset-2 col-xs-12">
            <div class="mainheading">

                
                
                
                
                <div class="row post-top-meta">
                    
                    <div class="col-md-2">
                        <img class="author-thumb" src="https://www.gravatar.com/avatar/64537dfe80f44978663e378d375c7138?s=150&amp;d=identicon&amp;r=PG" alt="Juri Strumpflohner">
                    </div>
                    <div class="col-md-10">
                        <a class="link-dark" href="/about/">Juri Strumpflohner</a><a href="https://twitter.com/@juristr"
                            class="btn follow">Follow</a>
                        <span class="author-description">Juri is a full stack developer and tech lead with a special passion for the web and frontend development. He creates online videos for <a href="https://egghead.io/instructors/juri-strumpflohner">Egghead.io</a>, writes articles on his blog and for tech magazines, speaks at conferences and holds training workshops. Juri is also a recognized Google Developer Expert in Web Technologies</span>
                        
                    </div>
                    
                </div>
                
                
                
                

                <h1 class="posttitle">Update to Angular Version 8 now!</h1>
                
                <h2 class="article-subtitle">What&#39;s new in Angular v8, how to update and what to watch out for</h2>
                
                <p>
                    <span class="post-date">
                        <time class="post-date">
                            Jun 3, 2019
                        </time></span>
                    <span class="dot"></span>
                    <span class="post-read">11 min read</span>
                </p>
            </div>

            
            
            

            
            <a href="https://egghead.io/courses/productive-git-for-developers?af=fj2vsx" class="external-link" data-client="eggheadio" data-uid="url">
                <img src="/assets/images/banners/egghead-banner-productive-git.png" style="width:100%" />
            </a>
            

            
            <div class="article-post">
                <div class="article-intro">
    Let&rsquo;s dive into the latest Angular version 8 that just got released. We&rsquo;ll quickly explore what&rsquo;s new, why you should update, how that works and what you should watch out for.
</div>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9669473064376287" data-ad-slot="2496274486"
    data-ad-format="auto"></ins>
<script>
    (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<p>Before you start, there&rsquo;s also an official post about the release from the Angular team:</p>

<div class="article-link card">
    <div class="row">
        <div class="col-2 share-link">
            <a href="https://blog.angular.io/version-8-of-angular-smaller-bundles-cli-apis-and-alignment-with-the-ecosystem-af0261112a27" target="_blank">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="w-8 mr-4 icon-external-window">
                    <path class="primary" d="M12 8a1 1 0 0 1-1 1H5v10h10v-6a1 1 0 0 1 2 0v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V9c0-1.1.9-2 2-2h6a1 1 0 0 1 1 1z"></path>
                    <path class="secondary" d="M19 6.41L8.7 16.71a1 1 0 1 1-1.4-1.42L17.58 5H14a1 1 0 0 1 0-2h6a1 1 0 0 1 1 1v6a1 1 0 0 1-2 0V6.41z"></path>
                </svg>
            </a>
        </div>
        <div class="col-10">
            <div class="title"><a href="https://blog.angular.io/version-8-of-angular-smaller-bundles-cli-apis-and-alignment-with-the-ecosystem-af0261112a27" target="_blank">Version 8 of Angular — Smaller bundles, CLI APIs, and alignment with the ecosystem</a></div>
            <div class="description"></div>
            <div class="link">
                https://blog.angular.io/version-8-of-angular-smaller-bundles-cli-apis-and-alignment-with-the-ecosystem-af0261112a27
            </div>
        </div>
    </div>
</div>

<hr />
<div class="article-toc">
    <strong>Table of contents</strong>
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#what-s-new-what-to-expect">What&rsquo;s new? What to expect</a></li>
<li><a href="#stay-up-to-date-evergreen-angular">Stay up to date! Evergreen Angular</a></li>
<li><a href="#how-to-update">How to update</a></li>
<li><a href="#what-to-watch-out-for">What to watch out for</a>
<ul>
<li><a href="#lazy-routes">Lazy routes</a></li>
<li><a href="#queries">Queries</a></li>
</ul></li>
<li><a href="#typescript-upgrade">TypeScript upgrade</a></li>
<li><a href="#other-deprecations">Other Deprecations</a></li>
<li><a href="#faq-potential-upgrade-issues">FAQ - Potential upgrade issues</a>
<ul>
<li><a href="#rerun-migrations">Rerun migrations</a></li>
<li><a href="#material-upgrade-fatal-error-ineffective-mark-compacts-near-heap-limit-allocation-failed-javascript-heap-out-of-memory">Material Upgrade: FATAL ERROR: Ineffective mark-compacts near heap limit Allocation failed - JavaScript heap out of memory</a></li>
<li><a href="#ngrx-type-observable-appconfigloaded-is-not-assignable-to-type-observable-action">Ngrx: Type &lsquo;Observable<AppConfigLoaded>&rsquo; is not assignable to type &lsquo;Observable<Action>&lsquo;</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
</div>
<hr />

<h2 id="what-s-new-what-to-expect">What&rsquo;s new? What to expect</h2>

<p>So what&rsquo;s new in v8. Many of the things have already been announced at this year&rsquo;s NGConf and I&rsquo;ve blogged about it here:</p>

<div class="article-link card">
    <div class="row">
        <div class="col-2 share-link">
            <a href="/blog/2019/05/Angular-8-and-the-Future-NGConf-2019-Roundup/" target="_blank">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="w-8 mr-4 icon-external-window">
                    <path class="primary" d="M12 8a1 1 0 0 1-1 1H5v10h10v-6a1 1 0 0 1 2 0v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V9c0-1.1.9-2 2-2h6a1 1 0 0 1 1 1z"></path>
                    <path class="secondary" d="M19 6.41L8.7 16.71a1 1 0 1 1-1.4-1.42L17.58 5H14a1 1 0 0 1 0-2h6a1 1 0 0 1 1 1v6a1 1 0 0 1-2 0V6.41z"></path>
                </svg>
            </a>
        </div>
        <div class="col-10">
            <div class="title"><a href="/blog/2019/05/Angular-8-and-the-Future-NGConf-2019-Roundup/" target="_blank">Angular 8 and the Future - NGConf 2019 Roundup</a></div>
            <div class="description"></div>
            <div class="link">
                /blog/2019/05/Angular-8-and-the-Future-NGConf-2019-Roundup/
            </div>
        </div>
    </div>
</div>

<p>Here are the main key points:</p>

<ul>
<li><strong>Differential loading -</strong> This feature produces separate bundles for legacy and evergreen browsers,thus reducing the amount of polyfills that have to be downloaded (~2-10% smaller bundles).</li>
<li><strong>Builders and Deploy -</strong> If you ever looked at the <code>angular.json</code> you may have notices the builder API (also known as Angular Architect). While it could already be used (i.e. <a href="https://github.com/manfredsteyer/ngx-build-plus">ngx-build-plus</a>), in v8 the API stabilized and gives 3rd party tooling to hook into the Angular build process. Moreover related to this change, the team also collaborated with the major cloud providers to integrate automated deployment of Angular apps to their respective infrastructure.</li>
<li><strong>Web Workers -</strong> Angular 8 now allows you to offload heavy work into a separate web worker, thus freeing up the main thread. This allows to further improve the speed and even execute things in parallel in the browser.</li>
<li><strong>Service Worker Improvements</strong></li>
<li><strong>Code-splitting via import -</strong> <code>import()</code> can now be used to execute code splitting</li>
<li><strong>AngularJS $location support -</strong> Some enhancements have been made to provide better integration with the AngularJS <code>$location</code> service in hybrid (AngularJS &lt;=&gt; Angular) apps.</li>
<li><strong>Better IDE completion</strong></li>
<li><strong>Simplified Getting Started Guide -</strong> The team has worked hard as well to simplify the <a href="https://angular.io/start">&ldquo;Getting Started&rdquo; Guide</a> and help new people onboard.</li>
</ul>

<p>But wait 🤔, <strong>where&rsquo;s Ivy?</strong> Right! Angular v8 ships with Ivy, however it won&rsquo;t be enabled by default, yet. The team has enabled Ivy within Google but wants to take another 6 months till v9 to get feedback from community projects. You can see Angular 8 as the transition to full, default Ivy support.<br />
That said, you can totally enable Ivy. Here&rsquo;s <a href="https://angular.io/guide/ivy">a guide how to do that</a>.</p>

<pre><code>$ ng new my-app --enable-ivy
</code></pre>

<p>Or for an existing app, by adding the <code>enableIvy</code> option to the <code>tsconfig.app.json</code>.</p>

<pre><code>{
  &quot;compilerOptions&quot;: { ... },
  &quot;angularCompilerOptions&quot;: {
    &quot;enableIvy&quot;: true
  }
}
</code></pre>

<p>If you enable Ivy and encounter any kind of issues, let me know!</p>

<p>Another experimental feature is <strong>Bazel</strong>. <a href="https://bazel.build/">Bazel</a> is Google&rsquo;s open source variant of their internal general purpose build system that powers their entire infrastructure. The Angular team jumped onto this bandwagon with <a href="https://bazel.angular.io/">https://bazel.angular.io/</a>, providing automated Bazel builds via the Angular CLI. Bazel is made to scale via</p>

<ul>
<li>incremental builds (sharing cache between team and CI)</li>
<li>full-stack support</li>
<li>scale on the cloud</li>
</ul>

<p>&hellip;and comes with some really good first performance improvement results</p>


<figure class="image--full">

    
        
        <a href="/blog/assets/imgs/ngconf2019/bazel-build-time-reduction.png" class="image--zoom">
            <img src="/blog/assets/imgs/ngconf2019/bazel-build-time-reduction.png" loading="lazy" class="lazyload"/>
        </a>
    
    <figcaption>First build time improvement results by Brad Green at ng-conf 2019</figcaption>
</figure>



<p>You can opt-into Bazel via</p>

<pre><code>$ npm i -g @angular/bazel
$ ng new my-app --collection=@angular/bazel
</code></pre>

<h2 id="stay-up-to-date-evergreen-angular">Stay up to date! Evergreen Angular</h2>

<p>It&rsquo;s again time for a new release. As you probably know, when the Angular team started with &ldquo;the new Angular&rdquo;, one of the promises was to be very serious about <a href="https://semver.org">semver</a> when releasing new versions (something that wasn&rsquo;t the case with Angular v1). Having such &ldquo;contract&rdquo; allows us to seamlessly upgrade minor and patch versions throughout the year. At the same time, however, this also means that at some point there will be breaking changes that are necessary to have the framework evolve.</p>

<p>Currently we have the following release schedule</p>

<ul>
<li>patch releases every week</li>
<li>~3 monthly minor releases after each major release</li>
<li>a major release every 6 months (usually September/October &amp; April/May)</li>
<li>12 months long-term support (LTS)</li>
</ul>

<p>Two major releases a year also means two potentially breaking changes, right? While this might seem to be an issue to worry about, it is not, thx to <strong>automated migration</strong> scripts. The team behind Angular is very cautious about breaking changes. One of the reasons being that they serve Google-internal teams and inside Google, breaking something means fixing it. You can imagine that updating hundreds of apps is not scalable. That&rsquo;s why the awesome tooling behind the Angular CLI provides &ldquo;schematics&rdquo;, &ldquo;intelligent&rdquo; scripts that are executed during the upgrade process and modify your codebase to automatically fix breaking changes. Have a look in the video below to see that in action.</p>

<p>That said, it&rsquo;s extremely important to keep your app up-to-date with the latest Angular version. Upgrading step by step will be much easier than not upgrading for years and then have to upgrade over multiple major versions.</p>

<h2 id="how-to-update">How to update</h2>

<p>When it comes to the update process itself, the <a href="https://update.angular.io">update.angular.io</a> site is extremely helpful.</p>


<figure class="image--full">

    
        
        <a href="/blog/assets/imgs/ng-update-site.png" class="image--zoom">
            <img src="/blog/assets/imgs/ng-update-site.png" loading="lazy" class="lazyload"/>
        </a>
    
    <figcaption></figcaption>
</figure>



<p>The site allows you to choose the start and target version and then gives you a set of instructions on how to update your codebase.</p>

<p>Check out the video below where I update an Angular Material based project from v7 to v8.</p>


<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="//www.youtube.com/embed/8a4Te-AO-9s" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>


<h2 id="what-to-watch-out-for">What to watch out for</h2>

<p>Here are some of the things you might immediately notice at the code level.</p>

<h3 id="lazy-routes">Lazy routes</h3>

<p>A couple of weeks ago I published an article about the various possibilities we have to apply lazy loading in Angular. You can find it here:</p>

<div class="article-link card">
    <div class="row">
        <div class="col-2 share-link">
            <a href="/blog/2019/04/state-lazy-loading-components-angular/" target="_blank">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="w-8 mr-4 icon-external-window">
                    <path class="primary" d="M12 8a1 1 0 0 1-1 1H5v10h10v-6a1 1 0 0 1 2 0v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V9c0-1.1.9-2 2-2h6a1 1 0 0 1 1 1z"></path>
                    <path class="secondary" d="M19 6.41L8.7 16.71a1 1 0 1 1-1.4-1.42L17.58 5H14a1 1 0 0 1 0-2h6a1 1 0 0 1 1 1v6a1 1 0 0 1-2 0V6.41z"></path>
                </svg>
            </a>
        </div>
        <div class="col-10">
            <div class="title"><a href="/blog/2019/04/state-lazy-loading-components-angular/" target="_blank">Lazy Load Angular Components</a></div>
            <div class="description"></div>
            <div class="link">
                /blog/2019/04/state-lazy-loading-components-angular/
            </div>
        </div>
    </div>
</div>

<p>One of them is via routing, and I&rsquo;m pretty sure you&rsquo;ve seen that already:</p>
<div class="highlight"><pre class="chroma"><code class="language-typescript" data-lang="typescript"><span class="kr">const</span> <span class="nx">routes</span>: <span class="kt">Routes</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="nx">path</span><span class="o">:</span> <span class="s1">&#39;issues&#39;</span><span class="p">,</span>
    <span class="nx">loadChildren</span><span class="o">:</span> <span class="s1">&#39;./issue-list/issue-list.module#IssueListModule&#39;</span><span class="p">,</span>
  <span class="p">}</span>
<span class="p">];</span></code></pre></div>
<p>So far, what we&rsquo;ve been using in Angular is this &ldquo;magic string&rdquo; passed to <code>loadChildren</code>, which was in turn picked up by the Angular CLI to know where to apply code splitting and load the JS file at runtime. Starting with v8, this magic string is no more necessary and has been aligned with the standard way of doing lazy loading across the various tools, which is by simply use an <code>import()</code> statement. As a result, we can now write the lazy route like</p>
<div class="highlight"><pre class="chroma"><code class="language-typescript" data-lang="typescript"><span class="kr">const</span> <span class="nx">routes</span>: <span class="kt">Routes</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="nx">path</span><span class="o">:</span> <span class="s1">&#39;issues&#39;</span><span class="p">,</span>
    <span class="nx">loadChildren</span><span class="o">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="kr">import</span><span class="p">(</span><span class="s1">&#39;./issue-list/issue-list.module&#39;</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">m</span> <span class="o">=&gt;</span> <span class="nx">m</span><span class="p">.</span><span class="nx">IssueListModule</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">];</span></code></pre></div>
<p>Note that when updating via the Angular CLI, the schematics will automatically transform your existing <code>loadChildren</code> to the new syntax 🎉.</p>

<h3 id="queries">Queries</h3>

<p>When talking about queries, we mean</p>

<ul>
<li><code>@ViewChild</code></li>
<li><code>@ContentChild</code>,</li>
<li><code>@ViewChildren</code> (not affected by the upgrade)</li>
<li><code>@ContentChildren</code> (not affected by the upgrade)</li>
</ul>

<p>When upgrading to v8, there&rsquo;s a small breaking change related to the <code>@ViewChild</code> and <code>@ContentChild</code>. The team tried to avoid it, but such things happen.</p>

<blockquote class="twitter-tweet"><p lang="en" dir="ltr">We literally spent most of this week trying to figure out how to make the static query as non-invasive as possible while correcting a really messed up and accidental behavior that ppl started to rely on.<br><br>We don&#39;t take breaking changes lightly. We really don&#39;t.</p>&mdash; Igor Minar 🇸🇰🇺🇸💙💛 (@IgorMinar) <a href="https://twitter.com/IgorMinar/status/1132066026311639041?ref_src=twsrc%5Etfw">May 24, 2019</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>During the upgrade you will get a notification with a link to more details.

<figure class="image--full">

    
        
        <a href="/blog/assets/imgs/querymigration.png" class="image--zoom">
            <img src="/blog/assets/imgs/querymigration.png" loading="lazy" class="lazyload"/>
        </a>
    
    <figcaption></figcaption>
</figure>

</p>

<p>You can read up all the details at <a href="https://angular.io/guide/static-query-migration">https://angular.io/guide/static-query-migration</a>.</p>

<p>If the Angular CLI is not able to automatically infer whether to use the static or dynamic resolution, it&rsquo;ll add a corresponding comment and warning on the console</p>


<figure class="image--full">

    
        
        <a href="/blog/assets/imgs/querymigration-manualwork.png" class="image--zoom">
            <img src="/blog/assets/imgs/querymigration-manualwork.png" loading="lazy" class="lazyload"/>
        </a>
    
    <figcaption></figcaption>
</figure>



<p><strong>To summarize, what is it all about?</strong></p>

<p>Assume you have the following:</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">foo</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span></code></pre></div>
<p>In your code you&rsquo;d use a <code>@ViewChild</code> such as</p>
<div class="highlight"><pre class="chroma"><code class="language-typescript" data-lang="typescript"><span class="kd">@ViewChild</span><span class="p">(</span><span class="nx">Foo</span><span class="p">)</span> <span class="nx">foo</span>: <span class="kt">Foo</span><span class="p">;</span></code></pre></div>
<p><em>(where <code>Foo</code> is some Angular directive)</em></p>

<p>Usually it&rsquo;s always safe to assume <code>foo</code> will be populated after the <code>ngAfterViewInit</code> (or <code>ngAfterContentInit</code> for content queries with <code>@ContentChild</code>). However, some of them were also accessible already in the <code>onInit</code> directly. The reason is that the compiler behind the scenes categories them in</p>

<ul>
<li><strong>static queries</strong> available immediately</li>
<li><strong>dynamic queries</strong> available only at runtime</li>
</ul>

<p>Our code example above would be an example of a <strong>static query</strong> because <code>&lt;div foo&gt;</code> it is immediately available. We could safely access it in the <code>ngOnInit</code>. On the other side, assume we change the code like</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">foo</span> <span class="err">*</span><span class="na">ngIf</span><span class="o">=</span><span class="s">&#34;isVisible&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span></code></pre></div>
<p>In such case, it would only become available once <code>isVisible</code> evaluates to true, which might happen at any time while executing the app. Such queries are <strong>dynamic queries</strong>.</p>

<p>The main problem is that this wasn&rsquo;t explicit. Hence, when upgrading to v8, the code migration will automatically transform your code to</p>
<div class="highlight"><pre class="chroma"><code class="language-typescript" data-lang="typescript"><span class="c1">// query results available in ngOnInit
</span><span class="c1"></span><span class="kd">@ViewChild</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="p">{</span><span class="kr">static</span><span class="o">:</span> <span class="kc">true</span><span class="p">})</span> <span class="nx">foo</span>: <span class="kt">ElementRef</span><span class="p">;</span> 

<span class="c1">// query results available in ngAfterViewInit
</span><span class="c1"></span><span class="kd">@ViewChild</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="p">{</span><span class="kr">static</span><span class="o">:</span> <span class="kc">false</span><span class="p">})</span> <span class="nx">foo</span>: <span class="kt">ElementRef</span><span class="p">;</span></code></pre></div>
<h2 id="typescript-upgrade">TypeScript upgrade</h2>

<p>By upgrading to Angular 8 you&rsquo;ll also upgrade to TypeScript 3.4. If you&rsquo;re curious about the new features <a href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-4.html">here&rsquo;s the corresponding documentation</a>.</p>

<p>As a result after the upgrade (even though that completes successfully), you may get errors. Most probably they are due to better type inference which reveal new potential typing issues.</p>

<h2 id="other-deprecations">Other Deprecations</h2>

<p>Check out the <a href="https://angular.io/guide/deprecations">new deprecation guide</a> on the official site. Still have questions? Open an issue in the <a href="https://github.com/angular/angular-cli">Angular CLI repository</a> if it&rsquo;s related to the upgrade or on the <a href="https://github.com/angular/angular">Angular repository</a> if it&rsquo;s framework related. Or simply ping <a href="https://twitter.com/juristr">me on Twitter</a> 😃</p>

<h2 id="faq-potential-upgrade-issues">FAQ - Potential upgrade issues</h2>

<h3 id="rerun-migrations">Rerun migrations</h3>

<p>What if you did the Angular upgrade, but for whatever reason some of the code transformations didn&rsquo;t complete successfully. You end up having Angular 8 (or whatever version you&rsquo;re upgrading) already in your node_modules folder and <code>package.json</code>.</p>

<p>Generally speaking, my suggestion is to use Git. Create a migration branch, which allows you to easily go back and forth during the upgrade. Commit after each step so you&rsquo;ve got a backup on the way.</p>

<p>Other than that, the Angular CLI also gives you the possibility to run the migration again, even though you already have the latest version in your <code>package.json</code>. Just execute</p>

<pre><code>// re-run CLI schematics
$ ng update @angular/cli --from 7 --to 8 --migrate-only

// re-run Angular core schematics
$ ng update @angular/core --from 7 --to 8 --migrate-only
</code></pre>

<h3 id="material-upgrade-fatal-error-ineffective-mark-compacts-near-heap-limit-allocation-failed-javascript-heap-out-of-memory">Material Upgrade: FATAL ERROR: Ineffective mark-compacts near heap limit Allocation failed - JavaScript heap out of memory</h3>

<p>When I upgraded Angular material with <code>ng update @angular/material</code> on our fairly large monorepo, I got the following exception.</p>

<pre><code>&lt;--- Last few GCs ---&gt;

[85884:0x103802200]   712051 ms: Scavenge 2004.6 (2047.9) -&gt; 2004.5 (2047.9) MB, 4.1 / 0.0 ms  (average mu = 0.199, current mu = 0.181) allocation failure
[85884:0x103802200]   712072 ms: Scavenge 2006.3 (2048.9) -&gt; 2004.6 (2048.4) MB, 3.8 / 0.0 ms  (average mu = 0.199, current mu = 0.181) allocation failure
[85884:0x103802200]   712077 ms: Scavenge 2005.6 (2049.4) -&gt; 2005.6 (2049.9) MB, 4.3 / 0.0 ms  (average mu = 0.199, current mu = 0.181) allocation failure


&lt;--- JS stacktrace ---&gt;

==== JS stack trace =========================================

    0: ExitFrame [pc: 0x100e146e6]
Security context: 0x08b76239a2f1 &lt;JSObject&gt;
    1: stringSlice(aka stringSlice) [0x8b725f97839] [buffer.js:~568] [pc=0x1d077761a16a](this=0x08b76f0804d1 &lt;undefined&gt;,0x08b765580f19 &lt;Uint8Array map = 0x8b742025759&gt;,0x08b786894e49 &lt;String[#4]: utf8&gt;,0,1073870)
    2: toString [0x8b7623f02f9] [buffer.js:~622] [pc=0x1d0777ee3789](this=0x08b765580f19 &lt;Uint8Array map = 0x8b742025759&gt;,0x08b786894e49 &lt;String[#4]:...

FATAL ERROR: Ineffective mark-compacts near heap limit Allocation failed - JavaScript heap out of memory
 1: 0x100075bd5 node::Abort() [/Users/jstrumpflohner/.nvm/versions/node/v12.4.0/bin/node]
 2: 0x100076316 node::errors::TryCatchScope::~TryCatchScope() [/Users/jstrumpflohner/.nvm/versions/node/v12.4.0/bin/node]
 3: 0x1001697d7 v8::Utils::ReportOOMFailure(v8::internal::Isolate*, char const*, bool) [/Users/jstrumpflohner/.nvm/versions/node/v12.4.0/bin/node]
 4: 0x10016976c v8::internal::V8::FatalProcessOutOfMemory(v8::internal::Isolate*, char const*, bool) [/Users/jstrumpflohner/.nvm/versions/node/v12.4.0/bin/node]
 5: 0x1005480d5 v8::internal::Heap::FatalProcessOutOfMemory(char const*) [/Users/jstrumpflohner/.nvm/versions/node/v12.4.0/bin/node]
 6: 0x1005491c3 v8::internal::Heap::CheckIneffectiveMarkCompact(unsigned long, double) [/Users/jstrumpflohner/.nvm/versions/node/v12.4.0/bin/node]
 7: 0x100546bc3 v8::internal::Heap::PerformGarbageCollection(v8::internal::GarbageCollector, v8::GCCallbackFlags) [/Users/jstrumpflohner/.nvm/versions/node/v12.4.0/bin/node]
 8: 0x10054487f v8::internal::Heap::CollectGarbage(v8::internal::AllocationSpace, v8::internal::GarbageCollectionReason, v8::GCCallbackFlags) [/Users/jstrumpflohner/.nvm/versions/node/v12.4.0/bin/node]
 ...
[1]    85884 abort      ng update @angular/material @angular/cdk @angular/cdk-experimental
</code></pre>

<p>This is a common issue when the node process needs more memory. To solve this, pass the <code>max_old_space_size</code> option to the node process, like this:</p>

<pre><code>$ node --max_old_space_size=8000 ./node_modules/.bin/ng update @angular/material @angular/cdk
</code></pre>

<h3 id="ngrx-type-observable-appconfigloaded-is-not-assignable-to-type-observable-action">Ngrx: Type &lsquo;Observable<AppConfigLoaded>&rsquo; is not assignable to type &lsquo;Observable<Action>&lsquo;</h3>

<p>Another strange error I got when upgrading my NX based monorepo from v7 to v8 was the following:</p>

<pre><code>ERROR in libs/r3-core/src/lib/+state/app-config/app-config.effects.ts(22,5): error TS2322: Type '(action: LoadAppConfig, state: AppConfigPartialState) =&gt; Observable&lt;AppConfigLoaded&gt;' is not assignable to type '(a: LoadAppConfig, state?: AppConfigPartialState) =&gt; void | Action | Observable&lt;Action&gt;'.
  Type 'Observable&lt;AppConfigLoaded&gt;' is not assignable to type 'void | Action | Observable&lt;Action&gt;'.
    Type 'Observable&lt;AppConfigLoaded&gt;' is not assignable to type 'Observable&lt;Action&gt;'.
      Types of property 'source' are incompatible.
        Type 'import(&quot;/Users/jstrumpflohner/myapp/node_modules/rxjs/internal/Observable&quot;).Observable&lt;any&gt;' is not assignable to type 'import(&quot;/Users/jstrumpflohner/myapp/node_modules/@nrwl/angular/node_modules/rxjs/internal/Observable&quot;).Observable&lt;any&gt;'.
          Types of property 'operator' are incompatible.
            Type 'import(&quot;/Users/jstrumpflohner/myapp/node_modules/rxjs/internal/Operator&quot;).Operator&lt;any, any&gt;' is not assignable to type 'import(&quot;/Users/jstrumpflohner/myapp/node_modules/@nrwl/angular/node_modules/rxjs/internal/Operator&quot;).Operator&lt;any, any&gt;'.
              Types of property 'call' are incompatible.
                Type '(subscriber: import(&quot;/Users/jstrumpflohner/myapp/node_modules/rxjs/internal/Subscriber&quot;).Subscriber&lt;any&gt;, source: any) =&gt; import(&quot;/Users/jstrumpflohner/myapp/node_modules/rxjs/internal/types&quot;).TeardownLogic' is not assignable to type '(subscriber: import(&quot;/Users/jstrumpflohner/myapp/node_modules/@nrwl/angular/node_modules/rxjs/internal/Subscriber&quot;).Subscriber&lt;any&gt;, source: any) =&gt; import(&quot;/Users/jstrumpflohner/myapp/node_modules/@nrwl/angular/node_modules/rxjs/internal/types&quot;).TeardownLogic'.
                  Types of parameters 'subscriber' and 'subscriber' are incompatible.
                    Property '_parentOrParents' is missing in type 'Subscriber&lt;any&gt;' but required in type 'Subscriber&lt;any&gt;'.
</code></pre>

<p>This seems due to an incompatibility between RxJS and Ngrx v7 in a certain version. Upgrading to Ngrx v8 might solve the issue (I didn&rsquo;t try though). In my case downgrading RxJS to <code>~6.4.0</code> helped.</p>

<pre><code>$ yarn add rxjs@~6.4.0
</code></pre>

<p>or</p>

<pre><code>$ npm i rxjs@~6.4.0 --save
</code></pre>

				<hr />

				Questions? Thoughts? Hit me up <a href="https://twitter.com/juristr" target="_blank">on Twitter</a>
            </div>

            
            <div class="after-post-tags">
                <ul class="tags">
                    
                    <li>
                        <a href="/tags/angular">angular</a>
                    </li>
                    
                </ul>
            </div>
            

            <a href="https://egghead.io/instructors/juri-strumpflohner" class="external-link" data-client="eggheadio"
                data-uid="egghead-instructor-page">
                <img src="/blog/assets/imgs/egghead-banner-learn-with-me.png" style="width:100%" />
            </a>

            
            
            
        </div>
        
    </div>
</div>

<div class="hideshare"></div>



<div class="related-container">
    <div class="container">
        <div class="row listrecent listrelated">
            
            

            <div class="col-md-4">
<div class="card">
    
    <div class="card-block">
        <h2 class="card-title">
            <a href="/blog/2019/05/Angular-8-and-the-Future-NGConf-2019-Roundup/">Angular 8 and the Future - NGConf 2019 Roundup</a>
        </h2>
        <h4 class="card-text">
            My core takeaway from NGConf 2019
            
        </h4>
        <div class="metafooter">
            <div class="wrapfooter">
                <div class="row">
                    <div class="col-10">
                        
                            <span class="meta-footer-thumb">
                                <a href="/about/">
                                    <img class="author-thumb" src="https://www.gravatar.com/avatar/64537dfe80f44978663e378d375c7138?s=150&amp;d=identicon&amp;r=PG" alt="Juri Strumpflohner">
                                </a>
                            </span>
                            <span class="author-meta">
                                <span class="post-name"><a href="/about/">Juri Strumpflohner</a></span><br />
                                <span class="post-date">May 1, 2019</span><span class="dot"></span><span
                                    class="post-read">36 min read</span>
                            </span>
                        
                    </div>
                    <div class="col-2">
                        
                        
                        
                        <span class="post-category-icon">
                            
                            
                                <img src="/assets/images/categories/angular.svg" />
                            
                        </span>
                        
                        
                    </div>
                </div>
            </div>
        </div>
    </div>

    
</div>

            </div>

            

            <div class="col-md-4">
<div class="card">
    
    <div class="card-block">
        <h2 class="card-title">
            <a href="/blog/2019/04/state-lazy-loading-components-angular">Lazy load Angular Components</a>
        </h2>
        <h4 class="card-text">
            Or better..how to lazy load Angular Modules. Learn about the state of lazy loading and lazy loading on steroids with Angular Elements
            
        </h4>
        <div class="metafooter">
            <div class="wrapfooter">
                <div class="row">
                    <div class="col-10">
                        
                            <span class="meta-footer-thumb">
                                <a href="/about/">
                                    <img class="author-thumb" src="https://www.gravatar.com/avatar/64537dfe80f44978663e378d375c7138?s=150&amp;d=identicon&amp;r=PG" alt="Juri Strumpflohner">
                                </a>
                            </span>
                            <span class="author-meta">
                                <span class="post-name"><a href="/about/">Juri Strumpflohner</a></span><br />
                                <span class="post-date">Apr 29, 2019</span><span class="dot"></span><span
                                    class="post-read">14 min read</span>
                            </span>
                        
                    </div>
                    <div class="col-2">
                        
                        
                        
                        <span class="post-category-icon">
                            
                            
                                <img src="/assets/images/categories/angular.svg" />
                            
                        </span>
                        
                        
                    </div>
                </div>
            </div>
        </div>
    </div>

    
</div>

            </div>

            

            <div class="col-md-4">
<div class="card">
    
    <div class="card-block">
        <h2 class="card-title">
            <a href="/blog/2019/04/intro-to-angular-elements">Introduction to Angular Elements</a>
        </h2>
        <h4 class="card-text">
            Learn how to automatically convert your Angular Components to native Custom Elements
            
        </h4>
        <div class="metafooter">
            <div class="wrapfooter">
                <div class="row">
                    <div class="col-10">
                        
                            <span class="meta-footer-thumb">
                                <a href="/about/">
                                    <img class="author-thumb" src="https://www.gravatar.com/avatar/64537dfe80f44978663e378d375c7138?s=150&amp;d=identicon&amp;r=PG" alt="Juri Strumpflohner">
                                </a>
                            </span>
                            <span class="author-meta">
                                <span class="post-name"><a href="/about/">Juri Strumpflohner</a></span><br />
                                <span class="post-date">Apr 28, 2019</span><span class="dot"></span><span
                                    class="post-read">5 min read</span>
                            </span>
                        
                    </div>
                    <div class="col-2">
                        
                        
                        
                        <span class="post-category-icon">
                            
                            
                                <img src="/assets/images/categories/angular.svg" />
                            
                        </span>
                        
                        
                    </div>
                </div>
            </div>
        </div>
    </div>

    
</div>

            </div>

            
            

        </div>
    </div>
</div>

<div class="container">
    <div id="comments" class="row justify-content-center mb-5">
        <div class="col-md-8">              
            <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "juristr" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>               
        </div>
    </div>
</div>



<script type="text/javascript" src="//downloads.mailchimp.com/js/signup-forms/popup/unique-methods/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script><script type="text/javascript">window.dojoRequire(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us4.list-manage.com","uuid":"04e83acc0ba14b18f30435204","lid":"1d83b68321","uniqueMethods":true}) })</script>
<div class="container">
    
<div class="footer">
    <p class="pull-left">
        &copy; Copyright Juri Strumpflohner - All rights reserved
    </p>
    <p class="pull-right">
        Customized Mediumish Theme, originally by <a target="_blank" href="https://www.wowthemes.net">WowThemes.net</a>
    </p>
    <div class="clearfix">
    </div>
</div>


</div>

    </div>

<script src="/js/jquery.min.js"></script>


<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-throttle-debounce/1.1/jquery.ba-throttle-debounce.min.js"></script>




<script type="text/javascript" src="/js/bundle.js" integrity=""></script>


<script src="/js/jquery.fluidbox.min.js"></script>
<script>
    $('a.image--zoom,.gallery>a').fluidbox();
</script>

<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-416229-12', 'juristr.com');
    ga('require', 'displayfeatures');
    ga('send', 'pageview');
  </script>






    
    <script type="text/javascript">
        window.cookieconsent_options = {
            "message": "This website uses cookies to ensure you get the best experience on our website",
            "dismiss": "Got it!",
            "learnMore": "More info",
            "link": null,
            "theme": "dark-bottom"
        };
    </script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/1.0.9/cookieconsent.min.js" defer></script>
    

    
    
    
    <script>
!function(t,e,a,c,x){var s='q';t[s]={publication_id:c,tags:x};
var s=e.createElement(a),r=e.getElementsByTagName(a)[0];s.async=1,s.src=
'https://insights.quiet.ly/app/analytics.min.js',r.parentNode.insertBefore(s,r)}
(window,document,'script','87bcee90-0c51-4a68-a60b-e95df730d1ca','[]');
</script>
    
 <script>
    if (window.netlifyIdentity) {
      window.netlifyIdentity.on("init", user => {
        if (!user) {
          window.netlifyIdentity.on("login", () => {
            document.location.href = "/admin/";
          });
        }
      });
    }
  </script>
</body>

</html>
