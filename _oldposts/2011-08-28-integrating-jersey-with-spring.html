---
layout: post
title: "Integrating Jersey with Spring"
date: 2011-08-28
comments: false
tags: [  JavaScript, Java, Spring, Web dev, Software Design ]
---

Spring provides a lot of benefits and promotes best practices with its dependency injection mechanism, application lifecycle management and Hibernate support (just to mention some). In addition when you want to have a clean server-side REST-like JSON Api, I found <a href="http://www.vogella.de/articles/REST/article.html">Jersey</a> to be quite handy. This article briefly highlights how both of them can be integrated.<br /><br /><a name='more'></a><br />In my little spare time I'm currently trying to revive one of my earlier private projects which never exited the private beta (I'll write more about it once I publish it). The project consists of a JavaScript rich client interface with a Java server "back-end" hosted on Google AppEngine. I'm currently completely rewriting it and so I started out cleanly by creating a Jersey REST Api on the server-side, that exposes it's data in JSON. An example of such Jersey-exposed class is the following:<br /><pre class="brush:java">@Path("/sourcecodeitems")<br />public class SourceCodeItemGateway {	<br />	...<br />	<br />	@GET<br />	@Produces(MediaType.APPLICATION_JSON)<br />	public List&lt;SourceCodeItemDTO&gt; index(){<br />		ArrayList&lt;SourceCodeItemDTO&gt; listOfItems = new ArrayList&lt;SourceCodeItemDTO&gt;();<br />		<br />		for (SourceCodeItem item : sourceCodeItems) {<br />			listOfItems.add(new SourceCodeItemDTO(item));<br />		}<br />		<br />		return listOfItems;<br />	}<br />	<br />	...	<br />}</pre>Actually this is quite similar (just a bit more complicated ;)) to an <a href="http://blog.js-development.com/2011/08/why-did-it-have-to-be-so-complicated.html">ASP.net MVC controller as described here</a>. The according web.config looks as follows:<br /><pre class="brush:xml; highlight:[12,15]">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br />&lt;web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"<br />	xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"<br />	xsi:schemaLocation="http://java.sun.com/xml/ns/javaee<br />http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"<br />	version="2.5"&gt;<br />	&lt;servlet&gt;<br />        &lt;servlet-name&gt;Jersey Web Application&lt;/servlet-name&gt;<br />        &lt;servlet-class&gt;com.sun.jersey.spi.container.servlet.ServletContainer&lt;/servlet-class&gt;<br />        &lt;init-param&gt;<br />            &lt;param-name&gt;com.sun.jersey.config.property.packages&lt;/param-name&gt;<br />            &lt;param-value&gt;com.jsdev.myproject.service&lt;/param-value&gt;<br />        &lt;/init-param&gt;<br />        &lt;init-param&gt;<br />			&lt;param-name&gt;com.sun.jersey.api.json.POJOMappingFeature&lt;/param-name&gt;<br />			&lt;param-value&gt;true&lt;/param-value&gt;<br />		&lt;/init-param&gt;<br />        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;<br />    &lt;/servlet&gt;<br />    &lt;servlet-mapping&gt;<br />        &lt;servlet-name&gt;Jersey Web Application&lt;/servlet-name&gt;<br />        &lt;url-pattern&gt;/backend/*&lt;/url-pattern&gt;<br />    &lt;/servlet-mapping&gt;<br />	&lt;welcome-file-list&gt;<br />		&lt;welcome-file&gt;welcome.jsp&lt;/welcome-file&gt;<br />	&lt;/welcome-file-list&gt;<br />&lt;/web-app&gt;</pre><b>Line 12</b>&nbsp;indicates the package where your Jersey resources lie and <b>line 15</b>&nbsp;activates the auto-mapping feature of your POJOs to Json.<br /><br /><span style="font-size: large;"><b>Integrating with Spring</b></span><br />In order to integrate Jersey with Spring, you first need to include the <b>jersey-spring-&lt;version&gt;.jar</b>&nbsp;that comes with the Jersey package download. Include it in your build-path. You can then either configure your Jersey resource (SourceCodeItemGateway above) using Spring annotations (@Component) or to do it xml-based like...<br /><pre class="brush:xml; highlight:[8]">&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br />&lt;beans xmlns="http://www.springframework.org/schema/beans"<br />	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"<br />	xsi:schemaLocation="http://www.springframework.org/schema/beans <br />	     http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;<br /><br /><br />	&lt;bean name="sourceCodeItemGateway" class="com.jsdev.mydevbook.service.SourceCodeItemGateway"&gt;<br />		&lt;property name="pingService" ref="pingService"/&gt;<br />	&lt;/bean&gt;<br />	<br />	&lt;bean id="pingService" class="com.jsdev.myproject.service.PingService"&gt;<br />	&lt;/bean&gt;<br /><br />&lt;/beans&gt;</pre><b>Line 8</b>&nbsp;shows the bean configuration of the Jersey resource class as well as a configured dependency (PingService) which will be managed and injected by Spring. Finally, you&nbsp;need to adapt the web.config file to properly hook in Spring with Jersey:<br /><pre class="brush:xml; highlight:[4,25,26]">&lt;servlet&gt;<br />    &lt;servlet-name&gt;jersey-servlet&lt;/servlet-name&gt;<br />    &lt;servlet-class&gt;<br />        com.sun.jersey.spi.spring.container.servlet.SpringServlet<br />    &lt;/servlet-class&gt;<br />	&lt;init-param&gt;<br />           &lt;param-name&gt;com.sun.jersey.config.property.packages&lt;/param-name&gt;<br />           &lt;param-value&gt;com.jsdev.myproject.service&lt;/param-value&gt;<br />       &lt;/init-param&gt;<br />	&lt;init-param&gt;<br />		&lt;param-name&gt;com.sun.jersey.api.json.POJOMappingFeature&lt;/param-name&gt;<br />		&lt;param-value&gt;true&lt;/param-value&gt;<br />	&lt;/init-param&gt;<br />	&lt;load-on-startup&gt;1&lt;/load-on-startup&gt;<br />&lt;/servlet&gt;<br /><br />&lt;servlet-mapping&gt;<br />    &lt;servlet-name&gt;jersey-servlet&lt;/servlet-name&gt;<br />    &lt;url-pattern&gt;/backend/*&lt;/url-pattern&gt;<br />&lt;/servlet-mapping&gt;<br /><br />&lt;context-param&gt;<br />	&lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;<br />	&lt;param-value&gt;<br />		/WEB-INF/spring-service.xml<br />		/WEB-INF/spring-data.xml<br />   	&lt;/param-value&gt;<br />&lt;/context-param&gt;</pre>Note in <b>line 4</b>&nbsp;how we instantiate the Jersey SpringServlet. <b>Line 25 and 26</b>&nbsp;show the path to the Spring configuration files. The previously shown bean configuration is an excerpt from the spring-service.xml. spring-data.xml is supposed to contain everything related to the data access.