---
layout: post
title: "GWT, App Engine and App Engine Data Classes"
date: 2010-02-23
comments: true
tags: [  GWT, Java, Projects, Web dev ]
---

I currently have some time before starting with my Master thesis project which will bring me back to Android programming. So to make use of that, I started to develop a project I already wanted to implement a couple of years ago, but due to my Master studies I didn't have the time to. I'll need some beta testers soon, so keep track of my blog here to catch the moment when everything goes online.<br />What I can reveal so far is that it will be a web application, using Google's <a href="http://code.google.com/webtoolkit/">GWT</a> and it will be hosted on Google's cloud computing platform <a href="http://appengine.google.com/">App Engin</a>e.<br /><br />Today I was finishing the implementation of the basic CRUD operations, using JDO and App Engine's DataNucleus DataStore. Now the app possibly needs to store large strings surely more than 255 characters. You'd think that shouldn't be a problem, but App Engine's DataStore has<a href="http://code.google.com/appengine/docs/java/datastore/usingjdo.html#Unsupported_Features_of_JDO"> some implications one should be aware of</a>. Beside these, there are some well defined core value types, under which there is the restriction that you have to use the <code>com.google.appengine.api.datastore.Text</code> instead of the <code>String</code> datatype if you plan to store more than 255 character strings. Ok, that shouldn't be a problem for us, should it? Well...not exactly. If you plan to use App Engine together with plain old JSP or whatever view technology that it won't be a problem, but if you use GWT you have to keep in mind that you're implementing a client-server system. The difference: the GWT client lives within the browser. So the data has to be transferred between the two end-points and has to be serializable accordingly. <code>com.google.appengine.api.datastore.Text</code> isn't serializable though. This means you <b>cannot</b>&nbsp;share your POJOs between your GWT client app and server-side code. Now you have different possibilities. Some that come to my mind right now are..<br /><ul><li>using DTOs (<a href="http://martinfowler.com/eaaCatalog/dataTransferObject.html">Data Transfer Objects</a>) which isn't that comfortable 'cause it causes a lot of boilerplate code</li><li>writing a serializable version of <code>com.google.appengine.api.datastore.Text</code> data class.</li></ul><div>Fortunately a guy has already implemented such a serializable version of <code>Text</code> and provides it for free. I just tried it out and it works&nbsp;seamlessly, without writing a single additional line of code. Here some steps on how to use it (available descriptions on the web are really bad).<br /><ol><li>Download the necessary jar files from&nbsp;<a href="http://www.resmarksystems.com/code/">http://www.resmarksystems.com/code/</a>:<br /><a href="http://www.resmarksystems.com/code/appengine-utils-client-1.0.jar">appengine-utils-client-1.0.jar</a><br /><a href="http://www.resmarksystems.com/code/appengine-utils-server-1.0.jar">appengine-utils-server-1.0.jar</a><br /><br /></li><li>Include the appengine-utils-client-1.0.jar in your build path. Copy the appengine-utils-server-1.0.jar to your WEB-INF/lib folder.<br /><br /></li><li>On your GWT module file add the following:<br /><br /><pre class="prettyprint">&lt;inherits name="com.resmarksystems.AppEngineDataTypes"/&gt;<br /><br /></pre></li><li>Restart your GWT app or compile it and everything should work as expected.</li></ol><div>Resmarksystem's version doesn't just provide serializable versions of <code>Text</code> but also for <code>Key</code>, <code>ShortBlob</code>, <code>Blob</code>, <code>Link</code>, <code>User</code>.<br />If you get exceptions like<br /><pre class="code">java.lang.ClassCastException: java.lang.String cannot be cast to com.google.appengine.api.datastore.Text</pre>or <br /><pre class="code">An IncompatibleRemoteServiceException was thrown while processing this call. </pre>then it's probably because you didn't correctly include the jar files as mentioned in step 2 above.</div></div>