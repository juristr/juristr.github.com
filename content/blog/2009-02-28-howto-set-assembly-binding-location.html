---
title: 'HowTo: Set the assembly binding location'
date: 2009-02-28T01:00:00.000Z
comments: true
categories:
- ".Net"
- 'C#'
url: /blog/2009/02/howto-set-assembly-binding-location
type: post
---

This post is somehow related to the <a href="http://blog.js-development.com/2009/02/howto-detect-assembly-dependencies-at.html">one
  I made just a couple of days ago</a>. The application plugins (dlls placed in a special folder of my app) are loaded
dynamically at run-time with my small "plugin framework" I'm developing. Now the problem I faced is that these plugins
may need additional 3rd-party dlls which are however then not found by the main application.<br />My first approach was
to attach a handler that is called when there are exceptions in loading a certain assembly. The idea would then have
been to modify the path of the assembly such that it points to a folder "dependencies" on my application where all the
needed 3rd-party dlls are deployed.<br />
<pre class="prettyprint">AppDomain.CurrentDomain.AssemblyResolve += new ResolveEventHandler(CurrentDomain_AssemblyResolve);<br /><br />System.Reflection.Assembly CurrentDomain_AssemblyResolve(object sender, ResolveEventArgs args)<br />{<br />    //find the path to the assembly and then load and return it by<br />    //return Assembly.Load("pathToDependencies/failedAssembly.dll");<br />}<br /></pre>This
seemed to work initially but sadly I got exceptions from the "Presentation.Zune.dll" which I was then not able to
handle properly. So thanks to the guys at <a href="http://stackoverflow.com/questions/592681/problems-loading-assembly-dependencies-dynamically-at-run-time">StackOverflow.com</a>
this is the final working solution. Put the following code in your App.config:<br />
<pre class="prettyprint">&lt;configuration&gt;<br />  &lt;runtime&gt;<br />    &lt;assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1"&gt;<br />      &lt;probing privatePath="dependencies"/&gt;<br />    &lt;/assemblyBinding&gt;<br />  &lt;/runtime&gt;<br />&lt;/configuration&gt;<br /></pre>"dependencies"
is the folder on the application directory where the 3rd-party dlls can be found.